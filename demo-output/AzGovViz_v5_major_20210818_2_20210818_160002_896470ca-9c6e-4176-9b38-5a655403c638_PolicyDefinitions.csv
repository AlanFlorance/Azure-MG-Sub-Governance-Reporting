"Scope";"ScopeId";"PolicyDisplayName";"PolicyDefinitionId";"PolicyEffect";"PolicyCategory";"RoleDefinitionsClear";"UniqueAssignments";"UsedInPolicySetsClean";"CreatedOn";"CreatedBy";"UpdatedOn";"UpdatedBy";"Json"
"Mg";"ESJH";"KeyVault SoftDelete should be enabled";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/append-kv-softdelete";"Fixed: append";"Key Vault";"n/a";"0";"0";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""KeyVault SoftDelete should be enabled"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""This policy enables you to ensure when a Key Vault is created with out soft delete enabled it will be added."",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Key Vault"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.492565Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {},
    ""policyRule"": {
      ""if"": {
        ""anyOf"": [
          {
            ""allOf"": [
              {
                ""field"": ""type"",
                ""equals"": ""Microsoft.KeyVault/vaults""
              },
              {
                ""field"": ""Microsoft.KeyVault/vaults/enableSoftDelete"",
                ""notEquals"": false
              }
            ]
          }
        ]
      },
      ""then"": {
        ""effect"": ""append"",
        ""details"": [
          {
            ""field"": ""Microsoft.KeyVault/vaults/enableSoftDelete"",
            ""value"": true
          }
        ]
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Append-KV-SoftDelete"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Append-KV-SoftDelete""
}"
"Mg";"ESJH";"No child resources in Automation Account";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deny-aa-child-resources";"Default: Deny; Allowed: Audit,Deny,Disabled";"Automation";"n/a";"0";"0";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""No child resources in Automation Account"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""This policy denies the creation of child resources on the Automation Account"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Automation"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.3290136Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""Audit"",
          ""Deny"",
          ""Disabled""
        ],
        ""defaultValue"": ""Deny""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""allOf"": [
          {
            ""field"": ""type"",
            ""in"": [
              ""Microsoft.Automation/automationAccounts/runbooks"",
              ""Microsoft.Automation/automationAccounts/variables"",
              ""Microsoft.Automation/automationAccounts/modules"",
              ""Microsoft.Automation/automationAccounts/credentials"",
              ""Microsoft.Automation/automationAccounts/connections"",
              ""Microsoft.Automation/automationAccount/certificates""
            ]
          }
        ]
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]""
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deny-AA-child-resources"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deny-AA-child-resources""
}"
"Mg";"ESJH";"Application Gateway should be deployed with WAF enabled";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deny-appgw-without-waf";"Default: Deny; Allowed: Audit,Deny,Disabled";"Network";"n/a";"0";"0";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Application Gateway should be deployed with WAF enabled"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""This policy enables you to restrict that Application Gateways is always deployed with WAF enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Network"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.3346641Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""Audit"",
          ""Deny"",
          ""Disabled""
        ],
        ""defaultValue"": ""Deny""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""allOf"": [
          {
            ""field"": ""type"",
            ""equals"": ""Microsoft.Network/applicationGateways""
          },
          {
            ""field"": ""Microsoft.Network/applicationGateways/sku.name"",
            ""notequals"": ""WAF_v2""
          }
        ]
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]""
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deny-AppGW-Without-WAF"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deny-AppGW-Without-WAF""
}"
"Mg";"ESJH";"Deny vNet peering ";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deny-erpeering";"Default: Deny; Allowed: Audit,Deny,Disabled";"Network";"n/a";"0";"0";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deny vNet peering "",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""This policy denies the creation of vNet Peerings under the assigned scope."",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Network"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.6692035Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""Audit"",
          ""Deny"",
          ""Disabled""
        ],
        ""defaultValue"": ""Deny""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.Network/virtualNetworks/virtualNetworkPeerings""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]""
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deny-ERPeering"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deny-ERPeering""
}"
"Mg";"ESJH";"Deny the creation of private DNS";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deny-private-dns-zones";"Default: Deny; Allowed: Audit,Deny,Disabled";"Network";"n/a";"0";"0";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deny the creation of private DNS"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""This policy denies the creation of a private DNS in the current scope, used in combination with policies that create centralized private DNS in connectivity subscription"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Network"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.590183Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""Audit"",
          ""Deny"",
          ""Disabled""
        ],
        ""defaultValue"": ""Deny""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.Network/privateDnsZones""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]""
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deny-Private-DNS-Zones"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deny-Private-DNS-Zones""
}"
"Mg";"ESJH";"Public network access on AKS API should be disabled";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deny-publicendpoint-aks";"Default: Deny; Allowed: Audit,Deny,Disabled";"Kubernetes";"n/a";"0";"1 (Public network access should be disabled for PAAS services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deny-publicendpoints)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Public network access on AKS API should be disabled"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""This policy denies  the creation of  Azure Kubernetes Service non-private clusters"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Kubernetes"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.4994662Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""Audit"",
          ""Deny"",
          ""Disabled""
        ],
        ""defaultValue"": ""Deny""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""allOf"": [
          {
            ""field"": ""type"",
            ""equals"": ""Microsoft.ContainerService/managedClusters""
          },
          {
            ""field"": ""Microsoft.ContainerService/managedClusters/apiServerAccessProfile.enablePrivateCluster"",
            ""notequals"": ""true""
          }
        ]
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]""
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicEndpoint-Aks"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deny-PublicEndpoint-Aks""
}"
"Mg";"ESJH";"Public network access should be disabled for CosmosDB";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deny-publicendpoint-cosmosdb";"Default: Deny; Allowed: Audit,Deny,Disabled";"SQL";"n/a";"0";"1 (Public network access should be disabled for PAAS services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deny-publicendpoints)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"2021-07-15 15:15:07";"ObjectType: User Member, ObjectDisplayName: Joe Dalton, ObjectSignInName: joe.dalton@AzGovViz.onmicrosoft.com, ObjectId: acf4c68f-7b15-4d70-935b-26116fc2426a";"{
  ""properties"": {
    ""displayName"": ""Public network access should be disabled for CosmosDB"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""This policy denies that  Cosmos database accounts  are created with out public network access is disabled."",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""SQL"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.8995781Z"",
      ""updatedBy"": ""acf4c68f-7b15-4d70-935b-26116fc2426a"",
      ""updatedOn"": ""2021-07-15T15:15:07.6208973Z""
    },
    ""parameters"": {
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of this policy""
        },
        ""allowedValues"": [
          ""Audit"",
          ""Deny"",
          ""Disabled""
        ],
        ""defaultValue"": ""Deny""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""allOf"": [
          {
            ""field"": ""type"",
            ""equals"": ""Microsoft.DocumentDB/databaseAccounts""
          },
          {
            ""field"": ""Microsoft.DocumentDB/databaseAccounts/publicNetworkAccess"",
            ""notequals"": ""Disabled""
          }
        ]
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]""
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicEndpoint-CosmosDB"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deny-PublicEndpoint-CosmosDB""
}"
"Mg";"ESJH";"Public network access should be disabled for KeyVault";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deny-publicendpoint-keyvault";"Default: Deny; Allowed: Audit,Deny,Disabled";"Key Vault";"n/a";"0";"1 (Public network access should be disabled for PAAS services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deny-publicendpoints)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Public network access should be disabled for KeyVault"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""This policy denies creation of Key Vaults with IP Firewall exposed to all public endpoints"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Key Vault"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.4941318Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""Audit"",
          ""Deny"",
          ""Disabled""
        ],
        ""defaultValue"": ""Deny""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""allOf"": [
          {
            ""field"": ""type"",
            ""equals"": ""Microsoft.KeyVault/vaults""
          },
          {
            ""field"": ""Microsoft.KeyVault/vaults/networkAcls.defaultAction"",
            ""notequals"": ""Deny""
          }
        ]
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]""
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicEndpoint-KeyVault"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deny-PublicEndpoint-KeyVault""
}"
"Mg";"ESJH";"Public network access should be disabled for MariaDB";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deny-publicendpoint-mariadb";"Default: Deny; Allowed: Audit,Deny,Disabled";"SQL";"n/a";"0";"1 (Public network access should be disabled for PAAS services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deny-publicendpoints)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Public network access should be disabled for MariaDB"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""This policy denies the creation of Maria DB accounts with exposed public endpoints"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""SQL"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.3939506Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""Audit"",
          ""Deny"",
          ""Disabled""
        ],
        ""defaultValue"": ""Deny""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""allOf"": [
          {
            ""field"": ""type"",
            ""equals"": ""Microsoft.DBforMariaDB/servers""
          },
          {
            ""field"": ""Microsoft.DBforMariaDB/servers/publicNetworkAccess"",
            ""notequals"": ""Disabled""
          }
        ]
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]""
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicEndpoint-MariaDB"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deny-PublicEndpoint-MariaDB""
}"
"Mg";"ESJH";"Public network access should be disabled for MySQL";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deny-publicendpoint-mysql";"Default: Deny; Allowed: Audit,Deny,Disabled";"SQL";"n/a";"0";"1 (Public network access should be disabled for PAAS services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deny-publicendpoints)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Public network access should be disabled for MySQL"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""This policy denies creation of MySql DB accounts with exposed public endpoints"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""SQL"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.5154942Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""Audit"",
          ""Deny"",
          ""Disabled""
        ],
        ""defaultValue"": ""Deny""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""allOf"": [
          {
            ""field"": ""type"",
            ""equals"": ""Microsoft.DBforMySQL/servers""
          },
          {
            ""field"": ""Microsoft.DBforMySQL/servers/publicNetworkAccess"",
            ""notequals"": ""Disabled""
          }
        ]
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]""
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicEndpoint-MySQL"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deny-PublicEndpoint-MySQL""
}"
"Mg";"ESJH";"Public network access should be disabled for PostgreSql";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deny-publicendpoint-postgresql";"Default: Deny; Allowed: Audit,Deny,Disabled";"SQL";"n/a";"0";"1 (Public network access should be disabled for PAAS services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deny-publicendpoints)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Public network access should be disabled for PostgreSql"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""This policy denies creation of Postgre SQL DB accounts with exposed public endpoints"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""SQL"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.4731381Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""Audit"",
          ""Deny"",
          ""Disabled""
        ],
        ""defaultValue"": ""Deny""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""allOf"": [
          {
            ""field"": ""type"",
            ""equals"": ""Microsoft.DBforPostgreSQL/servers""
          },
          {
            ""field"": ""Microsoft.DBforPostgreSQL/servers/publicNetworkAccess"",
            ""notequals"": ""Disabled""
          }
        ]
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]""
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicEndpoint-PostgreSql"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deny-PublicEndpoint-PostgreSql""
}"
"Mg";"ESJH";"Public network access on Azure SQL Database should be disabled";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deny-publicendpoint-sql";"Default: Deny; Allowed: Audit,Deny,Disabled";"SQL";"n/a";"0";"1 (Public network access should be disabled for PAAS services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deny-publicendpoints)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Public network access on Azure SQL Database should be disabled"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""This policy denies creation of Sql servers with exposed public endpoints"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""SQL"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.5127467Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""Audit"",
          ""Deny"",
          ""Disabled""
        ],
        ""defaultValue"": ""Deny""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""allOf"": [
          {
            ""field"": ""type"",
            ""equals"": ""Microsoft.Sql/servers""
          },
          {
            ""field"": ""Microsoft.Sql/servers/publicNetworkAccess"",
            ""notequals"": ""Disabled""
          }
        ]
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]""
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicEndpoint-Sql"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deny-PublicEndpoint-Sql""
}"
"Mg";"ESJH";"Public network access onStorage accounts should be disabled";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deny-publicendpoint-storage";"Default: Deny; Allowed: Audit,Deny,Disabled";"Storage";"n/a";"0";"1 (Public network access should be disabled for PAAS services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deny-publicendpoints)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Public network access onStorage accounts should be disabled"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""This policy denies creation of storage accounts with IP Firewall exposed to all public endpoints"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Storage"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.4973149Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""Audit"",
          ""Deny"",
          ""Disabled""
        ],
        ""defaultValue"": ""Deny""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""allOf"": [
          {
            ""field"": ""type"",
            ""equals"": ""Microsoft.Storage/storageAccounts""
          },
          {
            ""field"": ""Microsoft.Storage/storageAccounts/networkAcls.defaultAction"",
            ""notequals"": ""Deny""
          }
        ]
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]""
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicEndpoint-Storage"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deny-PublicEndpoint-Storage""
}"
"Mg";"ESJH";"Deny the creation of public IP";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deny-publicip";"Default: Deny; Allowed: Audit,Deny,Disabled";"Network";"n/a";"0";"0";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deny the creation of public IP"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""This policy denies creation of Public IPs under the assigned scope."",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Network"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.5671925Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""Audit"",
          ""Deny"",
          ""Disabled""
        ],
        ""defaultValue"": ""Deny""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.Network/publicIPAddresses""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]""
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deny-PublicIP"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deny-PublicIP""
}"
"Mg";"ESJH";"RDP access from the Internet should be blocked";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deny-rdp-from-internet";"Default: Deny; Allowed: Audit,Deny,Disabled";"Network";"n/a";"1 (/providers/microsoft.management/managementgroups/esjh-landingzones/providers/microsoft.authorization/policyassignments/deny-rdp-from-internet)";"0";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""RDP access from the Internet should be blocked"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""This policy denies any network security rule that allows RDP access from Internet"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Network"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.669552Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""Audit"",
          ""Deny"",
          ""Disabled""
        ],
        ""defaultValue"": ""Deny""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""allOf"": [
          {
            ""field"": ""type"",
            ""equals"": ""Microsoft.Network/networkSecurityGroups/securityRules""
          },
          {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Network/networkSecurityGroups/securityRules/access"",
                ""equals"": ""Allow""
              },
              {
                ""field"": ""Microsoft.Network/networkSecurityGroups/securityRules/direction"",
                ""equals"": ""Inbound""
              },
              {
                ""anyOf"": [
                  {
                    ""field"": ""Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange"",
                    ""equals"": ""*""
                  },
                  {
                    ""field"": ""Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange"",
                    ""equals"": ""3389""
                  },
                  {
                    ""value"": ""[if(and(not(empty(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'))), contains(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'),'-')), and(lessOrEquals(int(first(split(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'), '-'))),3389),greaterOrEquals(int(last(split(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange'), '-'))),3389)), 'false')]"",
                    ""equals"": ""true""
                  },
                  {
                    ""count"": {
                      ""field"": ""Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]"",
                      ""where"": {
                        ""value"": ""[if(and(not(empty(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')))), contains(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')),'-')), and(lessOrEquals(int(first(split(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')), '-'))),3389),greaterOrEquals(int(last(split(first(field('Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]')), '-'))),3389)) , 'false')]"",
                        ""equals"": ""true""
                      }
                    },
                    ""greater"": 0
                  },
                  {
                    ""not"": {
                      ""field"": ""Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]"",
                      ""notEquals"": ""*""
                    }
                  },
                  {
                    ""not"": {
                      ""field"": ""Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRanges[*]"",
                      ""notEquals"": ""3389""
                    }
                  }
                ]
              },
              {
                ""anyOf"": [
                  {
                    ""field"": ""Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix"",
                    ""equals"": ""*""
                  },
                  {
                    ""field"": ""Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix"",
                    ""equals"": ""Internet""
                  },
                  {
                    ""not"": {
                      ""field"": ""Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]"",
                      ""notEquals"": ""*""
                    }
                  },
                  {
                    ""not"": {
                      ""field"": ""Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefixes[*]"",
                      ""notEquals"": ""Internet""
                    }
                  }
                ]
              }
            ]
          }
        ]
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]""
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deny-RDP-From-Internet"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deny-RDP-From-Internet""
}"
"Mg";"ESJH";"Subnets should have a Network Security Group ";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deny-subnet-without-nsg";"Default: Deny; Allowed: Audit,Deny,Disabled";"Network";"n/a";"1 (/providers/microsoft.management/managementgroups/esjh-landingzones/providers/microsoft.authorization/policyassignments/deny-subnet-without-nsg)";"0";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Subnets should have a Network Security Group "",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""This policy denies the creation of a subsnet with out an Network Security Group. NSG help to protect traffic across subnet-level."",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Network"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.4698877Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""Audit"",
          ""Deny"",
          ""Disabled""
        ],
        ""defaultValue"": ""Deny""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""allOf"": [
          {
            ""field"": ""type"",
            ""equals"": ""Microsoft.Network/virtualNetworks/subnets""
          },
          {
            ""field"": ""Microsoft.Network/virtualNetworks/subnets/networkSecurityGroup.id"",
            ""exists"": ""false""
          }
        ]
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]""
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deny-Subnet-Without-Nsg"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deny-Subnet-Without-Nsg""
}"
"Mg";"ESJH";"Deploy Azure Defender settings in Azure Security Center.";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-asc-standard";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Security Center";"Security Admin";"1 (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policyassignments/deploy-asc-security)";"0";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Azure Defender settings in Azure Security Center."",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys  the Azure Defender settings in Azure Security Center for  the specific services."",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Security Center"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.5472725Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""pricingTierVMs"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""pricingTierVMs"",
          ""description"": null
        },
        ""allowedValues"": [
          ""Standard"",
          ""Free""
        ],
        ""defaultValue"": ""Standard""
      },
      ""pricingTierSqlServers"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""pricingTierSqlServers"",
          ""description"": null
        },
        ""allowedValues"": [
          ""Standard"",
          ""Free""
        ],
        ""defaultValue"": ""Standard""
      },
      ""pricingTierAppServices"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""pricingTierAppServices"",
          ""description"": null
        },
        ""allowedValues"": [
          ""Standard"",
          ""Free""
        ],
        ""defaultValue"": ""Standard""
      },
      ""pricingTierStorageAccounts"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""pricingTierStorageAccounts"",
          ""description"": null
        },
        ""allowedValues"": [
          ""Standard"",
          ""Free""
        ],
        ""defaultValue"": ""Standard""
      },
      ""pricingTierContainerRegistry"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""pricingTierContainerRegistry"",
          ""description"": null
        },
        ""allowedValues"": [
          ""Standard"",
          ""Free""
        ],
        ""defaultValue"": ""Standard""
      },
      ""pricingTierKeyVaults"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""pricingTierKeyVaults"",
          ""description"": null
        },
        ""allowedValues"": [
          ""Standard"",
          ""Free""
        ],
        ""defaultValue"": ""Standard""
      },
      ""pricingTierKubernetesService"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""pricingTierKubernetesService"",
          ""description"": null
        },
        ""allowedValues"": [
          ""Standard"",
          ""Free""
        ],
        ""defaultValue"": ""Standard""
      },
      ""pricingTierDns"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""pricingTierDns"",
          ""description"": null
        },
        ""allowedValues"": [
          ""Standard"",
          ""Free""
        ],
        ""defaultValue"": ""Standard""
      },
      ""pricingTierArm"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""pricingTierArm"",
          ""description"": null
        },
        ""allowedValues"": [
          ""Standard"",
          ""Free""
        ],
        ""defaultValue"": ""Standard""
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""allOf"": [
          {
            ""field"": ""type"",
            ""equals"": ""Microsoft.Resources/subscriptions""
          }
        ]
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Security/pricings"",
          ""deploymentScope"": ""subscription"",
          ""existenceScope"": ""subscription"",
          ""roleDefinitionIds"": [
            ""/providers/Microsoft.Authorization/roleDefinitions/fb1c8493-542b-48eb-b624-b4c8fea62acd""
          ],
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Security/pricings/pricingTier"",
                ""equals"": ""Standard""
              },
              {
                ""field"": ""type"",
                ""equals"": ""Microsoft.Security/pricings""
              }
            ]
          },
          ""deployment"": {
            ""location"": ""northeurope"",
            ""properties"": {
              ""mode"": ""incremental"",
              ""parameters"": {
                ""pricingTierVMs"": {
                  ""value"": ""[parameters('pricingTierVMs')]""
                },
                ""pricingTierSqlServers"": {
                  ""value"": ""[parameters('pricingTierSqlServers')]""
                },
                ""pricingTierAppServices"": {
                  ""value"": ""[parameters('pricingTierAppServices')]""
                },
                ""pricingTierStorageAccounts"": {
                  ""value"": ""[parameters('pricingTierStorageAccounts')]""
                },
                ""pricingTierContainerRegistry"": {
                  ""value"": ""[parameters('pricingTierContainerRegistry')]""
                },
                ""pricingTierKeyVaults"": {
                  ""value"": ""[parameters('pricingTierKeyVaults')]""
                },
                ""pricingTierKubernetesService"": {
                  ""value"": ""[parameters('pricingTierKubernetesService')]""
                },
                ""pricingTierDns"": {
                  ""value"": ""[parameters('pricingTierDns')]""
                },
                ""pricingTierArm"": {
                  ""value"": ""[parameters('pricingTierArm')]""
                }
              },
              ""template"": {
                ""$schema"": ""https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""pricingTierVMs"": {
                    ""type"": ""string"",
                    ""metadata"": {
                      ""description"": ""pricingTierVMs""
                    }
                  },
                  ""pricingTierSqlServers"": {
                    ""type"": ""string"",
                    ""metadata"": {
                      ""description"": ""pricingTierSqlServers""
                    }
                  },
                  ""pricingTierAppServices"": {
                    ""type"": ""string"",
                    ""metadata"": {
                      ""description"": ""pricingTierAppServices""
                    }
                  },
                  ""pricingTierStorageAccounts"": {
                    ""type"": ""string"",
                    ""metadata"": {
                      ""description"": ""pricingTierStorageAccounts""
                    }
                  },
                  ""pricingTierContainerRegistry"": {
                    ""type"": ""string"",
                    ""metadata"": {
                      ""description"": ""ContainerRegistry""
                    }
                  },
                  ""pricingTierKeyVaults"": {
                    ""type"": ""string"",
                    ""metadata"": {
                      ""description"": ""KeyVaults""
                    }
                  },
                  ""pricingTierKubernetesService"": {
                    ""type"": ""string"",
                    ""metadata"": {
                      ""description"": ""KubernetesService""
                    }
                  },
                  ""pricingTierDns"": {
                    ""type"": ""string"",
                    ""metadata"": {
                      ""description"": ""KubernetesService""
                    }
                  },
                  ""pricingTierArm"": {
                    ""type"": ""string"",
                    ""metadata"": {
                      ""description"": ""KubernetesService""
                    }
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Security/pricings"",
                    ""apiVersion"": ""2018-06-01"",
                    ""name"": ""VirtualMachines"",
                    ""properties"": {
                      ""pricingTier"": ""[parameters('pricingTierVMs')]""
                    }
                  },
                  {
                    ""type"": ""Microsoft.Security/pricings"",
                    ""apiVersion"": ""2018-06-01"",
                    ""name"": ""StorageAccounts"",
                    ""dependsOn"": [
                      ""[concat('Microsoft.Security/pricings/VirtualMachines')]""
                    ],
                    ""properties"": {
                      ""pricingTier"": ""[parameters('pricingTierStorageAccounts')]""
                    }
                  },
                  {
                    ""type"": ""Microsoft.Security/pricings"",
                    ""apiVersion"": ""2018-06-01"",
                    ""name"": ""AppServices"",
                    ""dependsOn"": [
                      ""[concat('Microsoft.Security/pricings/StorageAccounts')]""
                    ],
                    ""properties"": {
                      ""pricingTier"": ""[parameters('pricingTierAppServices')]""
                    }
                  },
                  {
                    ""type"": ""Microsoft.Security/pricings"",
                    ""apiVersion"": ""2018-06-01"",
                    ""name"": ""SqlServers"",
                    ""dependsOn"": [
                      ""[concat('Microsoft.Security/pricings/AppServices')]""
                    ],
                    ""properties"": {
                      ""pricingTier"": ""[parameters('pricingTierSqlServers')]""
                    }
                  },
                  {
                    ""type"": ""Microsoft.Security/pricings"",
                    ""apiVersion"": ""2018-06-01"",
                    ""name"": ""KeyVaults"",
                    ""dependsOn"": [
                      ""[concat('Microsoft.Security/pricings/SqlServers')]""
                    ],
                    ""properties"": {
                      ""pricingTier"": ""[parameters('pricingTierKeyVaults')]""
                    }
                  },
                  {
                    ""type"": ""Microsoft.Security/pricings"",
                    ""apiVersion"": ""2018-06-01"",
                    ""name"": ""KubernetesService"",
                    ""dependsOn"": [
                      ""[concat('Microsoft.Security/pricings/KeyVaults')]""
                    ],
                    ""properties"": {
                      ""pricingTier"": ""[parameters('pricingTierKubernetesService')]""
                    }
                  },
                  {
                    ""type"": ""Microsoft.Security/pricings"",
                    ""apiVersion"": ""2018-06-01"",
                    ""name"": ""ContainerRegistry"",
                    ""dependsOn"": [
                      ""[concat('Microsoft.Security/pricings/KubernetesService')]""
                    ],
                    ""properties"": {
                      ""pricingTier"": ""[parameters('pricingTierContainerRegistry')]""
                    }
                  },
                  {
                    ""type"": ""Microsoft.Security/pricings"",
                    ""apiVersion"": ""2018-06-01"",
                    ""name"": ""Dns"",
                    ""dependsOn"": [
                      ""[concat('Microsoft.Security/pricings/ContainerRegistry')]""
                    ],
                    ""properties"": {
                      ""pricingTier"": ""[parameters('pricingTierDns')]""
                    }
                  },
                  {
                    ""type"": ""Microsoft.Security/pricings"",
                    ""apiVersion"": ""2018-06-01"",
                    ""name"": ""Arm"",
                    ""dependsOn"": [
                      ""[concat('Microsoft.Security/pricings/Dns')]""
                    ],
                    ""properties"": {
                      ""pricingTier"": ""[parameters('pricingTierArm')]""
                    }
                  }
                ],
                ""outputs"": {}
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-ASC-Standard"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-ASC-Standard""
}"
"Mg";"ESJH";"Deploy a default budget on subscriptions";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-budget";"Fixed: DeployIfNotExists";"Budget";"Contributor";"0";"0";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy a default budget on subscriptions"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Depoloys a default budget on subscriptions."",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Budget"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.4777959Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""amount"": {
        ""type"": ""String"",
        ""metadata"": {
          ""description"": ""The total amount of cost or usage to track with the budget""
        },
        ""defaultValue"": ""1000""
      },
      ""timeGrain"": {
        ""type"": ""String"",
        ""metadata"": {
          ""description"": ""The time covered by a budget. Tracking of the amount will be reset based on the time grain.""
        },
        ""allowedValues"": [
          ""Monthly"",
          ""Quarterly"",
          ""Annually"",
          ""BillingMonth"",
          ""BillingQuarter"",
          ""BillingAnnual""
        ],
        ""defaultValue"": ""Monthly""
      },
      ""firstThreshold"": {
        ""type"": ""String"",
        ""metadata"": {
          ""description"": ""Threshold value associated with a notification. Notification is sent when the cost exceeded the threshold. It is always percent and has to be between 0 and 1000.""
        },
        ""defaultValue"": ""90""
      },
      ""secondThreshold"": {
        ""type"": ""String"",
        ""metadata"": {
          ""description"": ""Threshold value associated with a notification. Notification is sent when the cost exceeded the threshold. It is always percent and has to be between 0 and 1000.""
        },
        ""defaultValue"": ""100""
      },
      ""contactRoles"": {
        ""type"": ""Array"",
        ""metadata"": {
          ""description"": ""The list of contact RBAC roles, in an array, to send the budget notification to when the threshold is exceeded.""
        },
        ""defaultValue"": [
          ""Owner"",
          ""Contributor""
        ]
      },
      ""contactEmails"": {
        ""type"": ""Array"",
        ""metadata"": {
          ""description"": ""The list of email addresses, in an array, to send the budget notification to when the threshold is exceeded.""
        },
        ""defaultValue"": []
      },
      ""contactGroups"": {
        ""type"": ""Array"",
        ""metadata"": {
          ""description"": ""The list of action groups, in an array, to send the budget notification to when the threshold is exceeded. It accepts array of strings.""
        },
        ""defaultValue"": []
      }
    },
    ""policyRule"": {
      ""if"": {
        ""allOf"": [
          {
            ""field"": ""type"",
            ""equals"": ""Microsoft.Resources/subscriptions""
          }
        ]
      },
      ""then"": {
        ""effect"": ""DeployIfNotExists"",
        ""details"": {
          ""type"": ""Microsoft.Consumption/budgets"",
          ""deploymentScope"": ""Subscription"",
          ""existenceScope"": ""Subscription"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Consumption/budgets/amount"",
                ""equals"": ""[parameters('amount')]""
              },
              {
                ""field"": ""Microsoft.Consumption/budgets/timeGrain"",
                ""equals"": ""[parameters('timeGrain')]""
              },
              {
                ""field"": ""Microsoft.Consumption/budgets/category"",
                ""equals"": ""Cost""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c""
          ],
          ""deployment"": {
            ""location"": ""northeurope"",
            ""properties"": {
              ""mode"": ""incremental"",
              ""parameters"": {
                ""amount"": {
                  ""value"": ""[parameters('amount')]""
                },
                ""timeGrain"": {
                  ""value"": ""[parameters('timeGrain')]""
                },
                ""firstThreshold"": {
                  ""value"": ""[parameters('firstThreshold')]""
                },
                ""secondThreshold"": {
                  ""value"": ""[parameters('secondThreshold')]""
                },
                ""contactEmails"": {
                  ""value"": ""[parameters('contactEmails')]""
                },
                ""contactRoles"": {
                  ""value"": ""[parameters('contactRoles')]""
                },
                ""contactGroups"": {
                  ""value"": ""[parameters('contactGroups')]""
                }
              },
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""amount"": {
                    ""type"": ""string""
                  },
                  ""timeGrain"": {
                    ""type"": ""string""
                  },
                  ""firstThreshold"": {
                    ""type"": ""string""
                  },
                  ""secondThreshold"": {
                    ""type"": ""string""
                  },
                  ""contactEmails"": {
                    ""type"": ""array""
                  },
                  ""contactRoles"": {
                    ""type"": ""array""
                  },
                  ""contactGroups"": {
                    ""type"": ""array""
                  },
                  ""startDate"": {
                    ""type"": ""string"",
                    ""defaultValue"": ""[concat(utcNow('MM'), '/01/', utcNow('yyyy'))]""
                  }
                },
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Consumption/budgets"",
                    ""apiVersion"": ""2019-10-01"",
                    ""name"": ""default-sandbox-budget"",
                    ""properties"": {
                      ""timePeriod"": {
                        ""startDate"": ""[parameters('startDate')]""
                      },
                      ""timeGrain"": ""[parameters('timeGrain')]"",
                      ""amount"": ""[parameters('amount')]"",
                      ""category"": ""Cost"",
                      ""notifications"": {
                        ""NotificationForExceededBudget1"": {
                          ""enabled"": true,
                          ""operator"": ""GreaterThan"",
                          ""threshold"": ""[parameters('firstThreshold')]"",
                          ""contactEmails"": ""[parameters('contactEmails')]"",
                          ""contactRoles"": ""[parameters('contactRoles')]"",
                          ""contactGroups"": ""[parameters('contactGroups')]""
                        },
                        ""NotificationForExceededBudget2"": {
                          ""enabled"": true,
                          ""operator"": ""GreaterThan"",
                          ""threshold"": ""[parameters('secondThreshold')]"",
                          ""contactEmails"": ""[parameters('contactEmails')]"",
                          ""contactRoles"": ""[parameters('contactRoles')]"",
                          ""contactGroups"": ""[parameters('contactGroups')]""
                        }
                      }
                    }
                  }
                ]
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Budget"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Budget""
}"
"Mg";"ESJH";"Deploy an Azure DDoS Protection Standard plan";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-ddosprotection";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Network";"Network Contributor";"0";"0";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy an Azure DDoS Protection Standard plan"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys an Azure DDoS Protection Standard plan"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Network"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.6588825Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""ddosName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""ddosName"",
          ""description"": ""Name of the Virtual WAN""
        }
      },
      ""ddosRegion"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""ddosRegion"",
          ""description"": ""Select Azure region for Virtual WAN"",
          ""strongType"": ""location""
        }
      },
      ""rgName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""rgName"",
          ""description"": ""Provide name for resource group.""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""allOf"": [
          {
            ""field"": ""type"",
            ""equals"": ""Microsoft.Resources/subscriptions""
          }
        ]
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Network/ddosProtectionPlans"",
          ""deploymentScope"": ""Subscription"",
          ""existenceScope"": ""ResourceGroup"",
          ""resourceGroupName"": ""[parameters('rgName')]"",
          ""name"": ""[parameters('ddosName')]"",
          ""roleDefinitionIds"": [
            ""/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7""
          ],
          ""deployment"": {
            ""location"": ""northeurope"",
            ""properties"": {
              ""mode"": ""incremental"",
              ""parameters"": {
                ""rgName"": {
                  ""value"": ""[parameters('rgName')]""
                },
                ""ddosname"": {
                  ""value"": ""[parameters('ddosname')]""
                },
                ""ddosregion"": {
                  ""value"": ""[parameters('ddosRegion')]""
                }
              },
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""rgName"": {
                    ""type"": ""string""
                  },
                  ""ddosname"": {
                    ""type"": ""string""
                  },
                  ""ddosRegion"": {
                    ""type"": ""string""
                  }
                },
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Resources/resourceGroups"",
                    ""apiVersion"": ""2018-05-01"",
                    ""name"": ""[parameters('rgName')]"",
                    ""location"": ""[deployment().location]"",
                    ""properties"": {}
                  },
                  {
                    ""type"": ""Microsoft.Resources/deployments"",
                    ""apiVersion"": ""2018-05-01"",
                    ""name"": ""ddosprotection"",
                    ""resourceGroup"": ""[parameters('rgName')]"",
                    ""dependsOn"": [
                      ""[resourceId('Microsoft.Resources/resourceGroups/', parameters('rgName'))]""
                    ],
                    ""properties"": {
                      ""mode"": ""Incremental"",
                      ""template"": {
                        ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json"",
                        ""contentVersion"": ""1.0.0.0"",
                        ""parameters"": {},
                        ""resources"": [
                          {
                            ""type"": ""Microsoft.Network/ddosProtectionPlans"",
                            ""apiVersion"": ""2019-12-01"",
                            ""name"": ""[parameters('ddosName')]"",
                            ""location"": ""[parameters('ddosRegion')]"",
                            ""properties"": {}
                          }
                        ],
                        ""outputs"": {}
                      }
                    }
                  }
                ],
                ""outputs"": {}
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-DDoSProtection"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-DDoSProtection""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Automation to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-aa";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Automation to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Automation to stream to a Log Analytics workspace when any Automation which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.1308417Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.Automation/automationAccounts""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Automation/automationAccounts/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""timeGrain"": null,
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""enabled"": false,
                            ""days"": 0
                          }
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""JobLogs"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""JobStreams"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""DscNodeStatus"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AA"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-AA""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Container Instances to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-aci";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Container Instances to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Container Instances to stream to a Log Analytics workspace when any ACR which is missing this diagnostic settings is created or updated. The policy wil set the diagnostic with all metrics enabled."",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.5001774Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.ContainerInstance/containerGroups""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.ContainerInstance/containerGroups/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": []
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACI"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-ACI""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Container Registry to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-acr";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Container Registry to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Container Registry to stream to a Log Analytics workspace when any ACR which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics  enabled."",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.4946313Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.ContainerRegistry/registries""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.ContainerRegistry/registries/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""ContainerRegistryLoginEvents"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""ContainerRegistryRepositoryEvents"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ACR"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-ACR""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Activity Log to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-activitylog";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"1 (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policyassignments/deploy-azactivity-log)";"0";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Activity Log to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Activity Log to stream to a Log Analytics workspace when any Activity Log which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with category enabled."",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.6402081Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Primary Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""allOf"": [
          {
            ""field"": ""type"",
            ""equals"": ""Microsoft.Resources/subscriptions""
          }
        ]
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""deploymentScope"": ""Subscription"",
          ""existenceScope"": ""Subscription"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""deployment"": {
            ""location"": ""northeurope"",
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""name"": ""subscriptionToLa"",
                    ""type"": ""Microsoft.Insights/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""location"": ""Global"",
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""logs"": [
                        {
                          ""category"": ""Administrative"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""Security"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""ServiceHealth"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""Alert"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""Recommendation"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""Policy"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""Autoscale"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""ResourceHealth"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ]
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ActivityLog"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-ActivityLog""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Kubernetes Service to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-aks";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:37";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Kubernetes Service to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Kubernetes Service to stream to a Log Analytics workspace when any Kubernetes Service which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled."",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:37.7897371Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.ContainerService/managedClusters""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.ContainerService/managedClusters/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""kube-audit"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""kube-apiserver"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""kube-controller-manager"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""kube-scheduler"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""cluster-autoscaler"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""guard"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""kube-audit-admin"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AKS"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-AKS""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Analysis Services to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-analysisservice";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:37";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Analysis Services to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Analysis Services to stream to a Log Analytics workspace when any Analysis Services which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:37.7843307Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.AnalysisServices/servers""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.AnalysisServices/servers/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""Engine"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""Service"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-AnalysisService"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-AnalysisService""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for API Management to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-apimgmt";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for API Management to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for API Management to stream to a Log Analytics workspace when any API Management which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.474291Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.ApiManagement/service""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.ApiManagement/service/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""Gateway Requests"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        },
                        {
                          ""category"": ""Capacity"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        },
                        {
                          ""category"": ""EventHub Events"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        },
                        {
                          ""category"": ""Network Status"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""GatewayLogs"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-APIMgmt"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-APIMgmt""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Application Gateway to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-applicationgateway";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Application Gateway to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Application Gateway to stream to a Log Analytics workspace when any Application Gateway which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.7398799Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.Network/applicationGateways""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Network/applicationGateways/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""ApplicationGatewayAccessLog"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""ApplicationGatewayPerformanceLog"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""ApplicationGatewayFirewallLog"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ApplicationGateway"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-ApplicationGateway""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Batch to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-batch";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Batch to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Batch to stream to a Log Analytics workspace when any Batch which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.5031507Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.Batch/batchAccounts""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Batch/batchAccounts/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""ServiceLog"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Batch"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-Batch""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for CDN Endpoint to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-cdnendpoints";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for CDN Endpoint to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for CDN Endpoint to stream to a Log Analytics workspace when any CDN Endpoint which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.4860295Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.Cdn/profiles/endpoints""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Cdn/profiles/endpoints/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [],
                      ""logs"": [
                        {
                          ""category"": ""CoreAnalytics"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('fullName')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CDNEndpoints"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-CDNEndpoints""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Cognitive Services to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-cognitiveservices";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Cognitive Services to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Cognitive Services to stream to a Log Analytics workspace when any Cognitive Services which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.5078731Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.CognitiveServices/accounts""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.CognitiveServices/accounts/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""Audit"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""RequestResponse"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""Trace"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CognitiveServices"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-CognitiveServices""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Cosmos DB to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-cosmosdb";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Cosmos DB to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Cosmos DB to stream to a Log Analytics workspace when any Cosmos DB which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.5196791Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.DocumentDB/databaseAccounts""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.DocumentDB/databaseAccounts/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""Requests"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""DataPlaneRequests"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""MongoRequests"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""QueryRuntimeStatistics"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""PartitionKeyStatistics"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""PartitionKeyRUConsumption"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""ControlPlaneRequests"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""CassandraRequests"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""GremlinRequests"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-CosmosDB"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-CosmosDB""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Databricks to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-databricks";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Databricks to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Databricks to stream to a Log Analytics workspace when any Databricks which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.539725Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.Databricks/workspaces""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Databricks/workspaces/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""logs"": [
                        {
                          ""category"": ""dbfs"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""clusters"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""accounts"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""jobs"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""notebook"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""ssh"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""workspace"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""secrets"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""sqlPermissions"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""instancePools"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Databricks"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-Databricks""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Data Factory to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-datafactory";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Data Factory to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Data Factory to stream to a Log Analytics workspace when any Data Factory which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.506043Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.DataFactory/factories""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.DataFactory/factories/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""ActivityRuns"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""PipelineRuns"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""TriggerRuns"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""SSISPackageEventMessages"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""SSISPackageExecutableStatistics"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""SSISPackageEventMessageContext"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""SSISPackageExecutionComponentPhases"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""SSISPackageExecutionDataStatistics"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""SSISIntegrationRuntimeLogs"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataFactory"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-DataFactory""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Azure Data Lake Store to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-datalakestore";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Azure Data Lake Store to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Azure Data Lake Store to stream to a Log Analytics workspace when anyAzure Data Lake Store which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.4941318Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.DataLakeStore/accounts""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.DataLakeStore/accounts/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""Audit"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""Requests"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DataLakeStore"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-DataLakeStore""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Data Lake Analytics to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-dlanalytics";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Data Lake Analytics to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Data Lake Analytics to stream to a Log Analytics workspace when any Data Lake Analytics which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.5323155Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.DataLakeAnalytics/accounts""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.DataLakeAnalytics/accounts/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""Audit"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""Requests"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-DLAnalytics"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-DLAnalytics""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Event Grid subscriptions to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-eventgridsub";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Event Grid subscriptions to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Event Grid subscriptions to stream to a Log Analytics workspace when any Event Grid subscriptions which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.5589935Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.EventGrid/eventSubscriptions""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.EventGrid/eventSubscriptions/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": []
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSub"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-EventGridSub""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Event Grid System Topic to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-eventgridsystemtopic";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Event Grid System Topic to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Event Grid System Topic to stream to a Log Analytics workspace when any Event Grid System Topic which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.5598921Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.EventGrid/systemTopics""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.EventGrid/systemTopics/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""DeliveryFailures"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridSystemTopic"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-EventGridSystemTopic""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Event Grid Topic to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-eventgridtopic";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Event Grid Topic to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Event Grid Topic to stream to a Log Analytics workspace when any Event Grid Topic which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.4975041Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.EventGrid/topics""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.EventGrid/topics/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""DeliveryFailures"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""PublishFailures"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventGridTopic"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-EventGridTopic""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Event Hubs to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-eventhub";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:37";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Event Hubs to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Event Hubs to stream to a Log Analytics workspace when any Event Hubs which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:37.839052Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.EventHub/namespaces""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.EventHub/namespaces/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""ArchiveLogs"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""OperationalLogs"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""AutoScaleLogs"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""KafkaCoordinatorLogs"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""KafkaUserErrorLogs"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""EventHubVNetConnectionEvent"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""CustomerManagedKeyUserLogs"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-EventHub"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-EventHub""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for ExpressRoute to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-expressroute";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for ExpressRoute to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for ExpressRoute to stream to a Log Analytics workspace when any ExpressRoute which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.590183Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.Network/expressRouteCircuits""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Network/expressRouteCircuits/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""PeeringRouteLog"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ExpressRoute"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-ExpressRoute""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Firewall to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-firewall";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Firewall to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Firewall to stream to a Log Analytics workspace when any Firewall which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.4702368Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.Network/azureFirewalls""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Network/azureFirewalls/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""AzureFirewallApplicationRule"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""AzureFirewallNetworkRule"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""AzureFirewallDnsProxy"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Firewall"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-Firewall""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Front Door to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-frontdoor";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Front Door to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Front Door to stream to a Log Analytics workspace when any Front Door which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.4707789Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.Network/frontDoors""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Network/frontDoors/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""FrontdoorAccessLog"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""FrontdoorWebApplicationFirewallLog"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-FrontDoor"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-FrontDoor""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Azure Function App to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-function";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Azure Function App to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Azure Function App to stream to a Log Analytics workspace when any function app which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.5054179Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""allOf"": [
          {
            ""field"": ""type"",
            ""equals"": ""Microsoft.Web/sites""
          },
          {
            ""value"": ""[field('kind')]"",
            ""notEquals"": ""app""
          }
        ]
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Web/sites/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""FunctionAppLogs"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Function"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-Function""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for HDInsight to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-hdinsight";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for HDInsight to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for HDInsight to stream to a Log Analytics workspace when any HDInsight which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.4748877Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.HDInsight/clusters""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.HDInsight/clusters/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": []
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-HDInsight"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-HDInsight""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for IoT Hub to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-iothub";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for IoT Hub to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for IoT Hub to stream to a Log Analytics workspace when any IoT Hub which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.5030074Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.Devices/IotHubs""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Devices/IotHubs/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""Connections"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""DeviceTelemetry"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""C2DCommands"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""DeviceIdentityOperations"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""FileUploadOperations"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""Routes"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""D2CTwinOperations"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""C2DTwinOperations"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""TwinQueries"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""JobsOperations"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""DirectMethods"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""DistributedTracing"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""Configurations"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""DeviceStreams"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-iotHub"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-iotHub""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Key Vault to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-keyvault";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Key Vault to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Key Vault to stream to a Log Analytics workspace when any Key Vault which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.4863409Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.KeyVault/vaults""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""name"": ""setByPolicy"",
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.KeyVault/vaults/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""AuditEvent"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-KeyVault"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-KeyVault""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Load Balancer to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-loadbalancer";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Load Balancer to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Load Balancer to stream to a Log Analytics workspace when any Load Balancer which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.501068Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.Network/loadBalancers""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Network/loadBalancers/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""timeGrain"": null,
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""enabled"": false,
                            ""days"": 0
                          }
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""LoadBalancerAlertEvent"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""LoadBalancerProbeHealthStatus"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LoadBalancer"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-LoadBalancer""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Logic Apps integration service environment to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-logicappsise";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Logic Apps integration service environment to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Logic Apps integration service environment to stream to a Log Analytics workspace when any Logic Apps integration service environment which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.6996608Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.Logic/integrationAccounts""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Logic/integrationAccounts/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [],
                      ""logs"": [
                        {
                          ""category"": ""IntegrationAccountTrackingEvents"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogicAppsISE"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-LogicAppsISE""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Logic Apps Workflow runtime to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-logicappswf";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Logic Apps Workflow runtime to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Logic Apps Workflow runtimeto stream to a Log Analytics workspace when any Logic Apps Workflow runtime which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.5078255Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.Logic/workflows""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Logic/workflows/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""WorkflowRuntime"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-LogicAppsWF"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-LogicAppsWF""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for MariaDB to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-mariadb";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for MariaDB to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for MariaDB to stream to a Log Analytics workspace when any MariaDB  which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.6588825Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.DBforMariaDB/servers""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.DBforMariaDB/servers/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""MySqlSlowLogs"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""MySqlAuditLogs"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MariaDB"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-MariaDB""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Machine Learning workspace to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-mlworkspace";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Machine Learning workspace to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Machine Learning workspace to stream to a Log Analytics workspace when any Machine Learning workspace which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.3442864Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.MachineLearningServices/workspaces""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.MachineLearningServices/workspaces/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""Run"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        },
                        {
                          ""category"": ""Model"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": true
                          }
                        },
                        {
                          ""category"": ""Quota"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        },
                        {
                          ""category"": ""Resource"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""AmlComputeClusterEvent"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""AmlComputeClusterNodeEvent"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""AmlComputeJobEvent"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""AmlComputeCpuGpuUtilization"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""AmlRunStatusChangedEvent"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MlWorkspace"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-MlWorkspace""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Database for MySQL to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-mysql";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Database for MySQL to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Database for MySQL to stream to a Log Analytics workspace when any Database for MySQL which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.5329365Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.DBforMySQL/servers""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.DBforMySQL/servers/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""MySqlSlowLogs"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""MySqlAuditLogs"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-MySQL"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-MySQL""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Network Security Groups to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-networksecuritygroups";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Network Security Groups to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Network Security Groups to stream to a Log Analytics workspace when any Network Security Groups which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.4942927Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.Network/networkSecurityGroups""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Network/networkSecurityGroups/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [],
                      ""logs"": [
                        {
                          ""category"": ""NetworkSecurityGroupEvent"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""NetworkSecurityGroupRuleCounter"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NetworkSecurityGroups"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-NetworkSecurityGroups""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Network Interfaces to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-nic";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Network Interfaces to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Network Interfaces to stream to a Log Analytics workspace when any Network Interfaces which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.5350219Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.Network/networkInterfaces""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Network/networkInterfaces/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""timeGrain"": null,
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""enabled"": false,
                            ""days"": 0
                          }
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-NIC"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-NIC""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Database for PostgreSQL to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-postgresql";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Database for PostgreSQL to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Database for PostgreSQL to stream to a Log Analytics workspace when any Database for PostgreSQL which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.425534Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.DBforPostgreSQL/servers""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.DBforPostgreSQL/servers/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""PostgreSQLLogs"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""QueryStoreRuntimeStatistics"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""QueryStoreWaitStatistics"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PostgreSQL"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-PostgreSQL""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Power BI Embedded to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-powerbiembedded";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Power BI Embedded to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Power BI Embedded to stream to a Log Analytics workspace when any Power BI Embedded which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.5055081Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.PowerBIDedicated/capacities""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.PowerBIDedicated/capacities/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""Engine"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PowerBIEmbedded"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-PowerBIEmbedded""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Public IP addresses to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-publicip";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Public IP addresses to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Public IP addresses to stream to a Log Analytics workspace when any Public IP addresses which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.5019142Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.Network/publicIPAddresses""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Network/publicIPAddresses/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""timeGrain"": null,
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""enabled"": false,
                            ""days"": 0
                          }
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""DDoSProtectionNotifications"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""DDoSMitigationFlowLogs"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""DDoSMitigationReports"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-PublicIP"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-PublicIP""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Recovery Services vaults to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-recoveryvault";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Recovery Services vaults to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Recovery Services vaults to stream to a Log Analytics workspace when any Recovery Services vaults which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.5205102Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.RecoveryServices/vaults""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allof"": [
              {
                ""count"": {
                  ""field"": ""Microsoft.Insights/diagnosticSettings/logs[*]"",
                  ""where"": {
                    ""allof"": [
                      {
                        ""field"": ""Microsoft.Insights/diagnosticSettings/logs[*].Category"",
                        ""in"": [
                          ""CoreAzureBackup"",
                          ""AddonAzureBackupJobs"",
                          ""AddonAzureBackupAlerts"",
                          ""AddonAzureBackupPolicy"",
                          ""AddonAzureBackupStorage"",
                          ""AddonAzureBackupProtectedInstance"",
                          ""AzureBackupReport""
                        ]
                      },
                      {
                        ""field"": ""Microsoft.Insights/diagnosticSettings/logs[*].Enabled"",
                        ""equals"": ""True""
                      }
                    ]
                  }
                },
                ""Equals"": 7
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logAnalyticsDestinationType"",
                ""equals"": ""Dedicated""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.RecoveryServices/vaults/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""logAnalyticsDestinationType"": ""Dedicated"",
                      ""metrics"": [],
                      ""logs"": [
                        {
                          ""category"": ""CoreAzureBackup"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""AddonAzureBackupAlerts"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""AddonAzureBackupJobs"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""AddonAzureBackupPolicy"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""AddonAzureBackupProtectedInstance"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""AddonAzureBackupStorage"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""AzureBackupReport"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-RecoveryVault"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-RecoveryVault""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Redis Cache to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-rediscache";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:37";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Redis Cache to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Redis Cache to stream to a Log Analytics workspace when any Redis Cache which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:37.909672Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.Cache/redis""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Cache/redis/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": []
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-RedisCache"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-RedisCache""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Relay to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-relay";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Relay to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Relay to stream to a Log Analytics workspace when any Relay which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.5406453Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.Relay/namespaces""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Relay/namespaces/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""HybridConnectionsEvent"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Relay"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-Relay""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Search Services to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-searchservices";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Search Services to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Search Services to stream to a Log Analytics workspace when any Search Services which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.4772725Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.Search/searchServices""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Search/searchServices/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""OperationLogs"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SearchServices"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-SearchServices""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Service Bus namespaces  to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-servicebus";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Service Bus namespaces  to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for ServiceBus to stream to a Log Analytics workspace when any ServiceBus which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.3295991Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.ServiceBus/namespaces""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.ServiceBus/namespaces/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""OperationalLogs"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-ServiceBus"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-ServiceBus""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for SignalR to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-signalr";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for SignalR to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for SignalR to stream to a Log Analytics workspace when any SignalR which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.3400149Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.SignalRService/SignalR""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.SignalRService/SignalR/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""AllLogs"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SignalR"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-SignalR""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for SQL Databases  to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-sqldbs";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for SQL Databases  to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for SQL Databases to stream to a Log Analytics workspace when any SQL Databases  which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.5003655Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.Sql/servers/databases""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Sql/servers/databases/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""SQLInsights"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""AutomaticTuning"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""DevOpsOperationsAudit"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""QueryStoreRuntimeStatistics"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""QueryStoreWaitStatistics"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""Errors"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""DatabaseWaitStatistics"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""Timeouts"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""Blocks"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""Deadlocks"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""SQLSecurityAuditEvents"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('fullName')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLDBs"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-SQLDBs""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for SQL Elastic Pools to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-sqlelasticpools";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for SQL Elastic Pools to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for SQL Elastic Pools to stream to a Log Analytics workspace when any SQL Elastic Pools which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.5194649Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.Sql/servers/elasticPools""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Sql/servers/elasticPools/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": []
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('fullName')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLElasticPools"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-SQLElasticPools""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for SQL Managed Instances to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-sqlmi";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for SQL Managed Instances to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for SQL Managed Instances to stream to a Log Analytics workspace when any SQL Managed Instances which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.5105366Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.Sql/managedInstances""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Sql/managedInstances/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""logs"": [
                        {
                          ""category"": ""ResourceUsageStats"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""SQLSecurityAuditEvents"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""DevOpsOperationsAudit"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-SQLMI"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-SQLMI""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Stream Analytics to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-streamanalytics";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Stream Analytics to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Stream Analytics to stream to a Log Analytics workspace when any Stream Analytics which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.5000485Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.StreamAnalytics/streamingjobs""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.StreamAnalytics/streamingjobs/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""Execution"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""Authoring"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-StreamAnalytics"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-StreamAnalytics""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Time Series Insights to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-timeseriesinsights";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:37";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Time Series Insights to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Time Series Insights to stream to a Log Analytics workspace when any Time Series Insights which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:37.8011403Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.TimeSeriesInsights/environments""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.TimeSeriesInsights/environments/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""Ingress"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""Management"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TimeSeriesInsights"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-TimeSeriesInsights""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Traffic Manager to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-trafficmanager";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Traffic Manager to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Traffic Manager to stream to a Log Analytics workspace when any Traffic Manager which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.5208939Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.Network/trafficManagerProfiles""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Network/trafficManagerProfiles/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""ProbeHealthStatusEvents"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-TrafficManager"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-TrafficManager""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Virtual Network to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-virtualnetwork";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Virtual Network to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Virtual Network to stream to a Log Analytics workspace when any Virtual Network which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.7794633Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.Network/virtualNetworks""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Network/virtualNetworks/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""enabled"": false,
                            ""days"": 0
                          }
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""VMProtectionAlerts"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VirtualNetwork"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-VirtualNetwork""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Virtual Machines to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-vm";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Virtual Machines to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Virtual Machines to stream to a Log Analytics workspace when any Virtual Machines which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.0994966Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.Compute/virtualMachines""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Compute/virtualMachines/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""enabled"": false,
                            ""days"": 0
                          }
                        }
                      ],
                      ""logs"": []
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VM"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-VM""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for Virtual Machine Scale Sets to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-vmss";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for Virtual Machine Scale Sets to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Virtual Machine Scale Sets  to stream to a Log Analytics workspace when any Virtual Machine Scale Sets  which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.5009151Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.Compute/virtualMachineScaleSets""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Compute/virtualMachineScaleSets/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""enabled"": false,
                            ""days"": 0
                          }
                        }
                      ],
                      ""logs"": []
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VMSS"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-VMSS""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for VPN Gateway to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-vnetgw";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for VPN Gateway to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for VPN Gateway to stream to a Log Analytics workspace when any VPN Gateway which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled."",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.3345103Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.Network/virtualNetworkGateways""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Network/virtualNetworkGateways/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""GatewayDiagnosticLog"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""IKEDiagnosticLog"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""P2SDiagnosticLog"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""RouteDiagnosticLog"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""RouteDiagnosticLog"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""TunnelDiagnosticLog"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-VNetGW"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-VNetGW""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for App Service Plan to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-webserverfarm";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for App Service Plan to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for App Service Plan to stream to a Log Analytics workspace when any App Service Plan which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.4694696Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.Web/serverfarms""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Web/serverfarms/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": []
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-WebServerFarm"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-WebServerFarm""
}"
"Mg";"ESJH";"Deploy Diagnostic Settings for App Service to Log Analytics workspace";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-diagnostics-website";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"1 (Deploy Diagnostic Settings to Azure Services (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-diag-loganalytics)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Diagnostic Settings for App Service to Log Analytics workspace"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the diagnostic settings for Web App to stream to a Log Analytics workspace when any Web App which is missing this diagnostic settings is created or updated. The policy wil  set the diagnostic with all metrics and category enabled"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.4710459Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID."",
          ""strongType"": ""omsWorkspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      },
      ""profileName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Profile name"",
          ""description"": ""The diagnostic settings profile name""
        },
        ""defaultValue"": ""setbypolicy""
      },
      ""metricsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable metrics"",
          ""description"": ""Whether to enable metrics stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      },
      ""logsEnabled"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Enable logs"",
          ""description"": ""Whether to enable logs stream to the Log Analytics workspace - True or False""
        },
        ""allowedValues"": [
          ""True"",
          ""False""
        ],
        ""defaultValue"": ""True""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""allOf"": [
          {
            ""field"": ""type"",
            ""equals"": ""Microsoft.Web/sites""
          },
          {
            ""value"": ""[field('kind')]"",
            ""notContains"": ""functionapp""
          }
        ]
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Insights/diagnosticSettings"",
          ""name"": ""setByPolicy"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/logs.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/metrics.enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Insights/diagnosticSettings/workspaceId"",
                ""equals"": ""[parameters('logAnalytics')]""
              }
            ]
          },
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""resourceName"": {
                    ""type"": ""string""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""profileName"": {
                    ""type"": ""string""
                  },
                  ""metricsEnabled"": {
                    ""type"": ""string""
                  },
                  ""logsEnabled"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Web/sites/providers/diagnosticSettings"",
                    ""apiVersion"": ""2017-05-01-preview"",
                    ""name"": ""[concat(parameters('resourceName'), '/', 'Microsoft.Insights/', parameters('profileName'))]"",
                    ""location"": ""[parameters('location')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""workspaceId"": ""[parameters('logAnalytics')]"",
                      ""metrics"": [
                        {
                          ""category"": ""AllMetrics"",
                          ""enabled"": ""[parameters('metricsEnabled')]"",
                          ""retentionPolicy"": {
                            ""days"": 0,
                            ""enabled"": false
                          },
                          ""timeGrain"": null
                        }
                      ],
                      ""logs"": [
                        {
                          ""category"": ""AppServiceAntivirusScanAuditLogs"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""AppServiceHTTPLogs"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""AppServiceConsoleLogs"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""AppServiceHTTPLogs"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""AppServiceAppLogs"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""AppServiceFileAuditLogs"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""AppServiceAuditLogs"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""AppServiceIPSecAuditLogs"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        },
                        {
                          ""category"": ""AppServicePlatformLogs"",
                          ""enabled"": ""[parameters('logsEnabled')]""
                        }
                      ]
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""resourceName"": {
                  ""value"": ""[field('name')]""
                },
                ""profileName"": {
                  ""value"": ""[parameters('profileName')]""
                },
                ""metricsEnabled"": {
                  ""value"": ""[parameters('metricsEnabled')]""
                },
                ""logsEnabled"": {
                  ""value"": ""[parameters('logsEnabled')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Diagnostics-Website"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Diagnostics-Website""
}"
"Mg";"ESJH";"Deploy DNS Zone Group for Storage-Blob Private Endpoint";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-dnszonegroup-for-blob-privateendpoint";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Network";"Private DNS Zone Contributor";"0";"0";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy DNS Zone Group for Storage-Blob Private Endpoint"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the configurations of a Private DNS Zone Group by a parameter for Storage-Blob Private Endpoint. Used enforce the configuration to a single Private DNS Zone. "",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Network"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.5480105Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""privateDnsZoneId"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""privateDnsZoneId"",
          ""strongType"": ""Microsoft.Network/privateDnsZones""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""allOf"": [
          {
            ""field"": ""type"",
            ""equals"": ""Microsoft.Network/privateEndpoints""
          },
          {
            ""count"": {
              ""field"": ""Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]"",
              ""where"": {
                ""field"": ""Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]"",
                ""equals"": ""blob""
              }
            },
            ""greaterOrEquals"": 1
          }
        ]
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Network/privateEndpoints/privateDnsZoneGroups"",
          ""roleDefinitionIds"": [
            ""/providers/Microsoft.Authorization/roleDefinitions/b12aa53e-6015-4669-85d0-8515ebb3ae7f""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""privateDnsZoneId"": {
                    ""type"": ""string""
                  },
                  ""privateEndpointName"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  }
                },
                ""resources"": [
                  {
                    ""name"": ""[concat(parameters('privateEndpointName'), '/deployedByPolicy')]"",
                    ""type"": ""Microsoft.Network/privateEndpoints/privateDnsZoneGroups"",
                    ""apiVersion"": ""2020-03-01"",
                    ""location"": ""[parameters('location')]"",
                    ""properties"": {
                      ""privateDnsZoneConfigs"": [
                        {
                          ""name"": ""storageBlob-privateDnsZone"",
                          ""properties"": {
                            ""privateDnsZoneId"": ""[parameters('privateDnsZoneId')]""
                          }
                        }
                      ]
                    }
                  }
                ]
              },
              ""parameters"": {
                ""privateDnsZoneId"": {
                  ""value"": ""[parameters('privateDnsZoneId')]""
                },
                ""privateEndpointName"": {
                  ""value"": ""[field('name')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-DNSZoneGroup-For-Blob-PrivateEndpoint"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-DNSZoneGroup-For-Blob-PrivateEndpoint""
}"
"Mg";"ESJH";"Deploy DNS  Zone Group for Storage-File Private Endpoint";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-dnszonegroup-for-file-privateendpoint";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Network";"Private DNS Zone Contributor";"0";"0";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy DNS  Zone Group for Storage-File Private Endpoint"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the configurations of a Private DNS Zone Group by a parameter for Storage-File Private Endpoint. Used enforce the configuration to a single Private DNS Zone. "",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Network"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.401062Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""privateDnsZoneId"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""privateDnsZoneId"",
          ""strongType"": ""Microsoft.Network/privateDnsZones""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""allOf"": [
          {
            ""field"": ""type"",
            ""equals"": ""Microsoft.Network/privateEndpoints""
          },
          {
            ""count"": {
              ""field"": ""Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]"",
              ""where"": {
                ""field"": ""Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]"",
                ""equals"": ""file""
              }
            },
            ""greaterOrEquals"": 1
          }
        ]
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Network/privateEndpoints/privateDnsZoneGroups"",
          ""roleDefinitionIds"": [
            ""/providers/Microsoft.Authorization/roleDefinitions/b12aa53e-6015-4669-85d0-8515ebb3ae7f""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""privateDnsZoneId"": {
                    ""type"": ""string""
                  },
                  ""privateEndpointName"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  }
                },
                ""resources"": [
                  {
                    ""name"": ""[concat(parameters('privateEndpointName'), '/deployedByPolicy')]"",
                    ""type"": ""Microsoft.Network/privateEndpoints/privateDnsZoneGroups"",
                    ""apiVersion"": ""2020-03-01"",
                    ""location"": ""[parameters('location')]"",
                    ""properties"": {
                      ""privateDnsZoneConfigs"": [
                        {
                          ""name"": ""storageFile-privateDnsZone"",
                          ""properties"": {
                            ""privateDnsZoneId"": ""[parameters('privateDnsZoneId')]""
                          }
                        }
                      ]
                    }
                  }
                ]
              },
              ""parameters"": {
                ""privateDnsZoneId"": {
                  ""value"": ""[parameters('privateDnsZoneId')]""
                },
                ""privateEndpointName"": {
                  ""value"": ""[field('name')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-DNSZoneGroup-For-File-PrivateEndpoint"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-DNSZoneGroup-For-File-PrivateEndpoint""
}"
"Mg";"ESJH";"Deploy DNS  Zone Group for Key Vault Private Endpoint";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-dnszonegroup-for-keyvault-privateendpoint";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Network";"Private DNS Zone Contributor";"0";"0";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy DNS  Zone Group for Key Vault Private Endpoint"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the configurations of a Private DNS Zone Group by a parameter for Key Vault Private Endpoint. Used enforce the configuration to a single Private DNS Zone. "",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Network"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.584639Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""privateDnsZoneId"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""privateDnsZoneId"",
          ""strongType"": ""Microsoft.Network/privateDnsZones""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""allOf"": [
          {
            ""field"": ""type"",
            ""equals"": ""Microsoft.Network/privateEndpoints""
          },
          {
            ""count"": {
              ""field"": ""Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]"",
              ""where"": {
                ""field"": ""Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]"",
                ""equals"": ""vault""
              }
            },
            ""greaterOrEquals"": 1
          }
        ]
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Network/privateEndpoints/privateDnsZoneGroups"",
          ""roleDefinitionIds"": [
            ""/providers/Microsoft.Authorization/roleDefinitions/b12aa53e-6015-4669-85d0-8515ebb3ae7f""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""privateDnsZoneId"": {
                    ""type"": ""string""
                  },
                  ""privateEndpointName"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  }
                },
                ""resources"": [
                  {
                    ""name"": ""[concat(parameters('privateEndpointName'), '/deployedByPolicy')]"",
                    ""type"": ""Microsoft.Network/privateEndpoints/privateDnsZoneGroups"",
                    ""apiVersion"": ""2020-03-01"",
                    ""location"": ""[parameters('location')]"",
                    ""properties"": {
                      ""privateDnsZoneConfigs"": [
                        {
                          ""name"": ""keyVault-privateDnsZone"",
                          ""properties"": {
                            ""privateDnsZoneId"": ""[parameters('privateDnsZoneId')]""
                          }
                        }
                      ]
                    }
                  }
                ]
              },
              ""parameters"": {
                ""privateDnsZoneId"": {
                  ""value"": ""[parameters('privateDnsZoneId')]""
                },
                ""privateEndpointName"": {
                  ""value"": ""[field('name')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-DNSZoneGroup-For-KeyVault-PrivateEndpoint"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-DNSZoneGroup-For-KeyVault-PrivateEndpoint""
}"
"Mg";"ESJH";"Deploy DNS  Zone Group for Storage-Queue Private Endpoint";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-dnszonegroup-for-queue-privateendpoint";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Network";"Private DNS Zone Contributor";"0";"0";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy DNS  Zone Group for Storage-Queue Private Endpoint"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the configurations of a Private DNS Zone Group by a parameter for Storage-Queue Private Endpoint. Used enforce the configuration to a single Private DNS Zone. "",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Network"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.6688851Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""privateDnsZoneId"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""privateDnsZoneId"",
          ""strongType"": ""Microsoft.Network/privateDnsZones""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""allOf"": [
          {
            ""field"": ""type"",
            ""equals"": ""Microsoft.Network/privateEndpoints""
          },
          {
            ""count"": {
              ""field"": ""Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]"",
              ""where"": {
                ""field"": ""Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]"",
                ""equals"": ""queue""
              }
            },
            ""greaterOrEquals"": 1
          }
        ]
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Network/privateEndpoints/privateDnsZoneGroups"",
          ""roleDefinitionIds"": [
            ""/providers/Microsoft.Authorization/roleDefinitions/b12aa53e-6015-4669-85d0-8515ebb3ae7f""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""privateDnsZoneId"": {
                    ""type"": ""string""
                  },
                  ""privateEndpointName"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  }
                },
                ""resources"": [
                  {
                    ""name"": ""[concat(parameters('privateEndpointName'), '/deployedByPolicy')]"",
                    ""type"": ""Microsoft.Network/privateEndpoints/privateDnsZoneGroups"",
                    ""apiVersion"": ""2020-03-01"",
                    ""location"": ""[parameters('location')]"",
                    ""properties"": {
                      ""privateDnsZoneConfigs"": [
                        {
                          ""name"": ""storageQueue-privateDnsZone"",
                          ""properties"": {
                            ""privateDnsZoneId"": ""[parameters('privateDnsZoneId')]""
                          }
                        }
                      ]
                    }
                  }
                ]
              },
              ""parameters"": {
                ""privateDnsZoneId"": {
                  ""value"": ""[parameters('privateDnsZoneId')]""
                },
                ""privateEndpointName"": {
                  ""value"": ""[field('name')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-DNSZoneGroup-For-Queue-PrivateEndpoint"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-DNSZoneGroup-For-Queue-PrivateEndpoint""
}"
"Mg";"ESJH";"Deploy DNS  Zone Group for SQL Private Endpoint";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-dnszonegroup-for-sql-privateendpoint";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Network";"Private DNS Zone Contributor";"0";"0";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy DNS  Zone Group for SQL Private Endpoint"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the configurations of a Private DNS Zone Group by a parameter for SQL Private Private Endpoint. Used enforce the configuration to a single Private DNS Zone. "",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Network"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.5408129Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""privateDnsZoneId"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""privateDnsZoneId"",
          ""strongType"": ""Microsoft.Network/privateDnsZones""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""allOf"": [
          {
            ""field"": ""type"",
            ""equals"": ""Microsoft.Network/privateEndpoints""
          },
          {
            ""count"": {
              ""field"": ""Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]"",
              ""where"": {
                ""field"": ""Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]"",
                ""equals"": ""sqlServer""
              }
            },
            ""greaterOrEquals"": 1
          }
        ]
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Network/privateEndpoints/privateDnsZoneGroups"",
          ""roleDefinitionIds"": [
            ""/providers/Microsoft.Authorization/roleDefinitions/b12aa53e-6015-4669-85d0-8515ebb3ae7f""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""privateDnsZoneId"": {
                    ""type"": ""string""
                  },
                  ""privateEndpointName"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  }
                },
                ""resources"": [
                  {
                    ""name"": ""[concat(parameters('privateEndpointName'), '/deployedByPolicy')]"",
                    ""type"": ""Microsoft.Network/privateEndpoints/privateDnsZoneGroups"",
                    ""apiVersion"": ""2020-03-01"",
                    ""location"": ""[parameters('location')]"",
                    ""properties"": {
                      ""privateDnsZoneConfigs"": [
                        {
                          ""name"": ""sqlServer-privateDnsZone"",
                          ""properties"": {
                            ""privateDnsZoneId"": ""[parameters('privateDnsZoneId')]""
                          }
                        }
                      ]
                    }
                  }
                ]
              },
              ""parameters"": {
                ""privateDnsZoneId"": {
                  ""value"": ""[parameters('privateDnsZoneId')]""
                },
                ""privateEndpointName"": {
                  ""value"": ""[field('name')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-DNSZoneGroup-For-Sql-PrivateEndpoint"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-DNSZoneGroup-For-Sql-PrivateEndpoint""
}"
"Mg";"ESJH";"Deploy DNS  Zone Group for Storage-Blob Private Endpoint";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-dnszonegroup-for-table-privateendpoint";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Network";"Private DNS Zone Contributor";"0";"0";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy DNS  Zone Group for Storage-Blob Private Endpoint"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys the configurations of a Private DNS Zone Group by a parameter for Storage-Blob Private Endpoint. Used enforce the configuration to a single Private DNS Zone. "",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Network"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.5347224Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""privateDnsZoneId"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""privateDnsZoneId"",
          ""strongType"": ""Microsoft.Network/privateDnsZones""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""allOf"": [
          {
            ""field"": ""type"",
            ""equals"": ""Microsoft.Network/privateEndpoints""
          },
          {
            ""count"": {
              ""field"": ""Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]"",
              ""where"": {
                ""field"": ""Microsoft.Network/privateEndpoints/privateLinkServiceConnections[*].groupIds[*]"",
                ""equals"": ""table""
              }
            },
            ""greaterOrEquals"": 1
          }
        ]
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Network/privateEndpoints/privateDnsZoneGroups"",
          ""roleDefinitionIds"": [
            ""/providers/Microsoft.Authorization/roleDefinitions/b12aa53e-6015-4669-85d0-8515ebb3ae7f""
          ],
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""privateDnsZoneId"": {
                    ""type"": ""string""
                  },
                  ""privateEndpointName"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  }
                },
                ""resources"": [
                  {
                    ""name"": ""[concat(parameters('privateEndpointName'), '/deployedByPolicy')]"",
                    ""type"": ""Microsoft.Network/privateEndpoints/privateDnsZoneGroups"",
                    ""apiVersion"": ""2020-03-01"",
                    ""location"": ""[parameters('location')]"",
                    ""properties"": {
                      ""privateDnsZoneConfigs"": [
                        {
                          ""name"": ""storageTable-privateDnsZone"",
                          ""properties"": {
                            ""privateDnsZoneId"": ""[parameters('privateDnsZoneId')]""
                          }
                        }
                      ]
                    }
                  }
                ]
              },
              ""parameters"": {
                ""privateDnsZoneId"": {
                  ""value"": ""[parameters('privateDnsZoneId')]""
                },
                ""privateEndpointName"": {
                  ""value"": ""[field('name')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-DNSZoneGroup-For-Table-PrivateEndpoint"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-DNSZoneGroup-For-Table-PrivateEndpoint""
}"
"Mg";"ESJH";"Deploy Azure Firewall Manager policy in the subscription";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-firewallpolicy";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Network";"Network Contributor";"0";"0";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Azure Firewall Manager policy in the subscription"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys Azure Firewall Manager policy in subscription where the policy is assigned."",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Network"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.3971533Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""fwpolicy"": {
        ""type"": ""Object"",
        ""metadata"": {
          ""displayName"": ""fwpolicy"",
          ""description"": ""Object describing Azure Firewall Policy""
        },
        ""defaultValue"": {}
      },
      ""fwPolicyRegion"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""fwPolicyRegion"",
          ""description"": ""Select Azure region for Azure Firewall Policy"",
          ""strongType"": ""location""
        }
      },
      ""rgName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""rgName"",
          ""description"": ""Provide name for resource group.""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""allOf"": [
          {
            ""field"": ""type"",
            ""equals"": ""Microsoft.Resources/subscriptions""
          }
        ]
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Network/firewallPolicies"",
          ""deploymentScope"": ""Subscription"",
          ""existenceScope"": ""ResourceGroup"",
          ""resourceGroupName"": ""[parameters('rgName')]"",
          ""roleDefinitionIds"": [
            ""/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7""
          ],
          ""deployment"": {
            ""location"": ""northeurope"",
            ""properties"": {
              ""mode"": ""incremental"",
              ""parameters"": {
                ""rgName"": {
                  ""value"": ""[parameters('rgName')]""
                },
                ""fwPolicy"": {
                  ""value"": ""[parameters('fwPolicy')]""
                },
                ""fwPolicyRegion"": {
                  ""value"": ""[parameters('fwPolicyRegion')]""
                }
              },
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""rgName"": {
                    ""type"": ""string""
                  },
                  ""fwPolicy"": {
                    ""type"": ""object""
                  },
                  ""fwPolicyRegion"": {
                    ""type"": ""string""
                  }
                },
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Resources/resourceGroups"",
                    ""apiVersion"": ""2018-05-01"",
                    ""name"": ""[parameters('rgName')]"",
                    ""location"": ""[deployment().location]"",
                    ""properties"": {}
                  },
                  {
                    ""type"": ""Microsoft.Resources/deployments"",
                    ""apiVersion"": ""2018-05-01"",
                    ""name"": ""fwpolicies"",
                    ""resourceGroup"": ""[parameters('rgName')]"",
                    ""dependsOn"": [
                      ""[resourceId('Microsoft.Resources/resourceGroups/', parameters('rgName'))]""
                    ],
                    ""properties"": {
                      ""mode"": ""Incremental"",
                      ""template"": {
                        ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json"",
                        ""contentVersion"": ""1.0.0.0"",
                        ""parameters"": {},
                        ""variables"": {},
                        ""resources"": [
                          {
                            ""type"": ""Microsoft.Network/firewallPolicies"",
                            ""apiVersion"": ""2019-09-01"",
                            ""name"": ""[parameters('fwpolicy').firewallPolicyName]"",
                            ""location"": ""[parameters('fwpolicy').location]"",
                            ""dependsOn"": [],
                            ""tags"": {},
                            ""properties"": {},
                            ""resources"": [
                              {
                                ""type"": ""ruleGroups"",
                                ""apiVersion"": ""2019-09-01"",
                                ""name"": ""[parameters('fwpolicy').ruleGroups.name]"",
                                ""dependsOn"": [
                                  ""[resourceId('Microsoft.Network/firewallPolicies',parameters('fwpolicy').firewallPolicyName)]""
                                ],
                                ""properties"": {
                                  ""priority"": ""[parameters('fwpolicy').ruleGroups.properties.priority]"",
                                  ""rules"": ""[parameters('fwpolicy').ruleGroups.properties.rules]""
                                }
                              }
                            ]
                          }
                        ],
                        ""outputs"": {}
                      }
                    }
                  }
                ],
                ""outputs"": {}
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-FirewallPolicy"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-FirewallPolicy""
}"
"Mg";"ESJH";"Deploy Virtual Network to be used as hub virtual network in desired region";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-hub";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Network";"Network Contributor";"0";"0";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Virtual Network to be used as hub virtual network in desired region"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys Virtual Network to be used as hub virtual network in desired region in the subscription where this policy is assigned."",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Network"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.3758037Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""hubName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""hubName"",
          ""description"": ""Name of the Hub""
        }
      },
      ""HUB"": {
        ""type"": ""Object"",
        ""metadata"": {
          ""displayName"": ""HUB"",
          ""description"": ""Object describing HUB""
        }
      },
      ""vpngw"": {
        ""type"": ""Object"",
        ""metadata"": {
          ""displayName"": ""vpngw"",
          ""description"": ""Object describing VPN gateway""
        },
        ""defaultValue"": {}
      },
      ""ergw"": {
        ""type"": ""Object"",
        ""metadata"": {
          ""displayName"": ""ergw"",
          ""description"": ""Object describing ExpressRoute gateway""
        },
        ""defaultValue"": {}
      },
      ""azfw"": {
        ""type"": ""Object"",
        ""metadata"": {
          ""displayName"": ""ergw"",
          ""description"": ""Object describing ExpressRoute gateway""
        },
        ""defaultValue"": {}
      },
      ""rgName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""rgName"",
          ""description"": ""Provide name for resource group.""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""allOf"": [
          {
            ""field"": ""type"",
            ""equals"": ""Microsoft.Resources/subscriptions""
          }
        ]
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Network/virtualNetworks"",
          ""name"": ""[parameters('hubName')]"",
          ""deploymentScope"": ""Subscription"",
          ""existenceScope"": ""ResourceGroup"",
          ""ResourceGroupName"": ""[parameters('rgName')]"",
          ""roleDefinitionIds"": [
            ""/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7""
          ],
          ""deployment"": {
            ""location"": ""northeurope"",
            ""properties"": {
              ""mode"": ""incremental"",
              ""parameters"": {
                ""rgName"": {
                  ""value"": ""[parameters('rgName')]""
                },
                ""hubName"": {
                  ""value"": ""[parameters('hubName')]""
                },
                ""HUB"": {
                  ""value"": ""[parameters('HUB')]""
                },
                ""vpngw"": {
                  ""value"": ""[parameters('vpngw')]""
                },
                ""ergw"": {
                  ""value"": ""[parameters('ergw')]""
                },
                ""azfw"": {
                  ""value"": ""[parameters('azfw')]""
                }
              },
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""hubName"": {
                    ""type"": ""string"",
                    ""metadata"": {
                      ""description"": ""Name of the HUB""
                    }
                  },
                  ""HUB"": {
                    ""type"": ""object"",
                    ""metadata"": {
                      ""description"": ""Object describing HUB""
                    }
                  },
                  ""vpngw"": {
                    ""type"": ""object"",
                    ""defaultValue"": {},
                    ""metadata"": {
                      ""description"": ""Object describing VPN gateway""
                    }
                  },
                  ""ergw"": {
                    ""type"": ""object"",
                    ""defaultValue"": {},
                    ""metadata"": {
                      ""description"": ""Object describing ExpressRoute gateway""
                    }
                  },
                  ""azfw"": {
                    ""type"": ""object"",
                    ""defaultValue"": {},
                    ""metadata"": {
                      ""description"": ""Object describing the Azure Firewall""
                    }
                  },
                  ""rgName"": {
                    ""type"": ""String"",
                    ""metadata"": {
                      ""displayName"": ""rgName"",
                      ""description"": ""Provide name for resource group.""
                    }
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Resources/resourceGroups"",
                    ""apiVersion"": ""2020-06-01"",
                    ""name"": ""[parameters('rgName')]"",
                    ""location"": ""[deployment().location]"",
                    ""properties"": {}
                  },
                  {
                    ""type"": ""Microsoft.Resources/deployments"",
                    ""apiVersion"": ""2020-06-01"",
                    ""name"": ""[concat(parameters('hubName'),'-', parameters('HUB').location)]"",
                    ""resourceGroup"": ""[parameters('rgName')]"",
                    ""dependsOn"": [
                      ""[resourceId('Microsoft.Resources/resourceGroups/', parameters('rgName'))]""
                    ],
                    ""properties"": {
                      ""mode"": ""Incremental"",
                      ""template"": {
                        ""$schema"": ""https: //schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#"",
                        ""contentVersion"": ""1.0.0.0"",
                        ""parameters"": {},
                        ""variables"": {},
                        ""resources"": [
                          {
                            ""name"": ""[parameters('hubName')]"",
                            ""type"": ""Microsoft.Network/virtualNetworks"",
                            ""apiVersion"": ""2020-04-01"",
                            ""location"": ""[parameters('HUB').location]"",
                            ""properties"": {
                              ""addressSpace"": {
                                ""addressPrefixes"": [
                                  ""[parameters('HUB').addressPrefix]""
                                ]
                              },
                              ""subnets"": [
                                {
                                  ""name"": ""Infrastructure"",
                                  ""properties"": {
                                    ""addressPrefix"": ""[if(not(empty(parameters('HUB').subnets.infra)),parameters('HUB').subnets.infra, json('null'))]""
                                  }
                                },
                                {
                                  ""name"": ""AzureFirewallSubnet"",
                                  ""properties"": {
                                    ""addressPrefix"": ""[if(not(empty(parameters('HUB').subnets.azfw)),parameters('HUB').subnets.azfw, json('null'))]""
                                  }
                                },
                                {
                                  ""name"": ""GatewaySubnet"",
                                  ""properties"": {
                                    ""addressPrefix"": ""[if(not(empty(parameters('HUB').subnets.gw)),parameters('HUB').subnets.gw, json('null'))]""
                                  }
                                }
                              ]
                            }
                          }
                        ]
                      }
                    }
                  },
                  {
                    ""type"": ""Microsoft.Resources/deployments"",
                    ""apiVersion"": ""2020-06-01"",
                    ""condition"": ""[greater(length(parameters('vpngw')),0)]"",
                    ""resourceGroup"": ""[parameters('rgName')]"",
                    ""dependsOn"": [
                      ""[concat(parameters('hubName'),'-', parameters('HUB').location)]""
                    ],
                    ""name"": ""[concat(parameters('hubName'),'-vpngw')]"",
                    ""properties"": {
                      ""mode"": ""Incremental"",
                      ""template"": {
                        ""$schema"": ""https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#"",
                        ""contentVersion"": ""1.0.0.0"",
                        ""parameters"": {},
                        ""variables"": {},
                        ""resources"": [
                          {
                            ""apiVersion"": ""2020-05-01"",
                            ""type"": ""Microsoft.Network/publicIpAddresses"",
                            ""location"": ""[parameters('HUB').location]"",
                            ""name"": ""[concat(parameters('vpngw').name,'-pip')]"",
                            ""properties"": {
                              ""publicIPAllocationMethod"": ""Dynamic""
                            },
                            ""tags"": {}
                          },
                          {
                            ""apiVersion"": ""2020-05-01"",
                            ""name"": ""[parameters('vpngw').name]"",
                            ""type"": ""Microsoft.Network/virtualNetworkGateways"",
                            ""location"": ""[parameters('HUB').location]"",
                            ""dependsOn"": [
                              ""[concat('Microsoft.Network/publicIPAddresses/', parameters('vpngw').name,'-pip')]""
                            ],
                            ""tags"": {},
                            ""properties"": {
                              ""gatewayType"": ""Vpn"",
                              ""vpnType"": ""[parameters('vpngw').vpnType]"",
                              ""ipConfigurations"": [
                                {
                                  ""name"": ""default"",
                                  ""properties"": {
                                    ""privateIPAllocationMethod"": ""Dynamic"",
                                    ""subnet"": {
                                      ""id"": ""[concat(subscription().id,'/resourceGroups/',parameters('rgName'), '/providers','/Microsoft.Network/virtualNetworks/', parameters('hubName'),'/subnets/GatewaySubnet')]""
                                    },
                                    ""publicIpAddress"": {
                                      ""id"": ""[concat(subscription().id,'/resourceGroups/',parameters('rgName'), '/providers','/Microsoft.Network/publicIPAddresses/', parameters('vpngw').name,'-pip')]""
                                    }
                                  }
                                }
                              ],
                              ""sku"": {
                                ""name"": ""[parameters('vpngw').sku]"",
                                ""tier"": ""[parameters('vpngw').sku]""
                              }
                            }
                          }
                        ]
                      }
                    }
                  },
                  {
                    ""type"": ""Microsoft.Resources/deployments"",
                    ""apiVersion"": ""2020-06-01"",
                    ""condition"": ""[greater(length(parameters('ergw')),0)]"",
                    ""resourceGroup"": ""[parameters('rgName')]"",
                    ""dependsOn"": [
                      ""[concat(parameters('hubName'),'-', parameters('HUB').location)]""
                    ],
                    ""name"": ""[concat(parameters('hubName'),'-ergw')]"",
                    ""properties"": {
                      ""mode"": ""Incremental"",
                      ""template"": {
                        ""$schema"": ""https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#"",
                        ""contentVersion"": ""1.0.0.0"",
                        ""parameters"": {},
                        ""variables"": {},
                        ""resources"": [
                          {
                            ""apiVersion"": ""2020-05-01"",
                            ""type"": ""Microsoft.Network/publicIpAddresses"",
                            ""location"": ""[parameters('HUB').location]"",
                            ""name"": ""[concat(parameters('ergw').name,'-pip')]"",
                            ""properties"": {
                              ""publicIPAllocationMethod"": ""Dynamic""
                            },
                            ""tags"": {}
                          },
                          {
                            ""apiVersion"": ""2020-05-01"",
                            ""name"": ""[parameters('ergw').name]"",
                            ""type"": ""Microsoft.Network/virtualNetworkGateways"",
                            ""location"": ""[parameters('HUB').location]"",
                            ""dependsOn"": [
                              ""[concat('Microsoft.Network/publicIPAddresses/', parameters('ergw').name,'-pip')]""
                            ],
                            ""tags"": {},
                            ""properties"": {
                              ""gatewayType"": ""ExpressRoute"",
                              ""ipConfigurations"": [
                                {
                                  ""name"": ""default"",
                                  ""properties"": {
                                    ""privateIPAllocationMethod"": ""Dynamic"",
                                    ""subnet"": {
                                      ""id"": ""[concat(subscription().id,'/resourceGroups/',parameters('rgName'), '/providers','/Microsoft.Network/virtualNetworks/', parameters('hubName'),'/subnets/GatewaySubnet')]""
                                    },
                                    ""publicIpAddress"": {
                                      ""id"": ""[concat(subscription().id,'/resourceGroups/',parameters('rgName'), '/providers','/Microsoft.Network/publicIPAddresses/', parameters('ergw').name,'-pip')]""
                                    }
                                  }
                                }
                              ],
                              ""sku"": {
                                ""name"": ""[parameters('ergw').sku]"",
                                ""tier"": ""[parameters('ergw').sku]""
                              }
                            }
                          }
                        ]
                      }
                    }
                  },
                  {
                    ""type"": ""Microsoft.Resources/deployments"",
                    ""apiVersion"": ""2020-06-01"",
                    ""condition"": ""[greater(length(parameters('azfw')),0)]"",
                    ""name"": ""[concat(parameters('hubName'),'-azfw')]"",
                    ""resourceGroup"": ""[parameters('rgName')]"",
                    ""dependsOn"": [
                      ""[concat(parameters('hubName'),'-', parameters('HUB').location)]""
                    ],
                    ""properties"": {
                      ""mode"": ""Incremental"",
                      ""template"": {
                        ""$schema"": ""https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#"",
                        ""contentVersion"": ""1.0.0.0"",
                        ""parameters"": {},
                        ""variables"": {},
                        ""resources"": [
                          {
                            ""apiVersion"": ""2020-05-01"",
                            ""type"": ""Microsoft.Network/publicIpAddresses"",
                            ""name"": ""[concat(parameters('azfw').name,'-pip')]"",
                            ""location"": ""[parameters('azfw').location]"",
                            ""sku"": {
                              ""name"": ""Standard""
                            },
                            ""zones"": ""[if(contains(parameters('azfw'),'pipZones'),parameters('azfw').pipZones,json('null'))]"",
                            ""properties"": {
                              ""publicIPAllocationMethod"": ""Static""
                            },
                            ""tags"": {}
                          },
                          {
                            ""apiVersion"": ""2020-05-01"",
                            ""type"": ""Microsoft.Network/azureFirewalls"",
                            ""name"": ""[parameters('azfw').name]"",
                            ""location"": ""[parameters('azfw').location]"",
                            ""zones"": ""[if(contains(parameters('azfw'),'fwZones'),parameters('azfw').fwZones,json('null'))]"",
                            ""dependsOn"": [
                              ""[concat(parameters('azfw').name,'-pip')]""
                            ],
                            ""properties"": {
                              ""threatIntelMode"": ""[parameters('azfw').threatIntelMode]"",
                              ""additionalProperties"": ""[if(contains(parameters('azfw'),'additionalProperties'),parameters('azfw').additionalProperties,json('null'))]"",
                              ""sku"": ""[if(contains(parameters('azfw'),'sku'),parameters('azfw').sku,json('null'))]"",
                              ""ipConfigurations"": [
                                {
                                  ""name"": ""[concat(parameters('azfw').name,'-pip')]"",
                                  ""properties"": {
                                    ""subnet"": {
                                      ""id"": ""[concat(subscription().id,'/resourceGroups/',parameters('rgName'), '/providers','/Microsoft.Network/virtualNetworks/', parameters('hubName'),'/subnets/AzureFirewallSubnet')]""
                                    },
                                    ""publicIPAddress"": {
                                      ""id"": ""[concat(subscription().id,'/resourceGroups/',parameters('rgName'), '/providers','/Microsoft.Network/publicIPAddresses/', parameters('azfw').name,'-pip')]""
                                    }
                                  }
                                }
                              ],
                              ""firewallPolicy"": ""[if(contains(parameters('azfw'),'firewallPolicy'),parameters('azfw').firewallPolicy,json('null'))]""
                            },
                            ""tags"": {}
                          }
                        ]
                      }
                    }
                  }
                ]
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-HUB"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-HUB""
}"
"Mg";"ESJH";"Deploy the configurations to the Log Analytics in the subscription";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-la-config";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"0";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy the configurations to the Log Analytics in the subscription"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploy the configurations to the Log Analytics in the subscription. This includes a list of solutions like update, automation etc and  enables the vminsight counters. "",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.5409206Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""workspaceName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""workspaceName"",
          ""description"": ""Provide name of existing Log Analytics workspace""
        }
      },
      ""workspaceRegion"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""workspaceRegion"",
          ""description"": ""Select region of existing Log Analytics workspace""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""allOf"": [
          {
            ""field"": ""type"",
            ""equals"": ""Microsoft.OperationalInsights/workspaces""
          }
        ]
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.OperationalInsights/workspaces"",
          ""deploymentScope"": ""resourceGroup"",
          ""existenceScope"": ""Subscription"",
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""name"",
                ""like"": ""[parameters('workspaceName')]""
              },
              {
                ""field"": ""location"",
                ""equals"": ""[parameters('workspaceRegion')]""
              }
            ]
          },
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""parameters"": {
                ""workspaceName"": {
                  ""value"": ""[parameters('workspaceName')]""
                },
                ""workspaceRegion"": {
                  ""value"": ""[parameters('workspaceRegion')]""
                }
              },
              ""template"": {
                ""$schema"": ""https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""workspaceName"": {
                    ""type"": ""string""
                  },
                  ""workspaceRegion"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {
                  ""vmInsightsPerfCounters"": {
                    ""windowsArray"": [
                      {
                        ""armName"": ""counter1"",
                        ""objectName"": ""LogicalDisk"",
                        ""counterName"": ""% Free Space"",
                        ""instanceName"": ""*"",
                        ""intervalSeconds"": 10
                      },
                      {
                        ""armName"": ""counter2"",
                        ""objectName"": ""LogicalDisk"",
                        ""counterName"": ""Avg. Disk sec/Read"",
                        ""instanceName"": ""*"",
                        ""intervalSeconds"": 10
                      },
                      {
                        ""armName"": ""counter3"",
                        ""objectName"": ""LogicalDisk"",
                        ""counterName"": ""Avg. Disk sec/Transfer"",
                        ""instanceName"": ""*"",
                        ""intervalSeconds"": 10
                      },
                      {
                        ""armName"": ""counter4"",
                        ""objectName"": ""LogicalDisk"",
                        ""counterName"": ""Avg. Disk sec/Write"",
                        ""instanceName"": ""*"",
                        ""intervalSeconds"": 10
                      },
                      {
                        ""armName"": ""counter5"",
                        ""objectName"": ""LogicalDisk"",
                        ""counterName"": ""Disk Read Bytes/sec"",
                        ""instanceName"": ""*"",
                        ""intervalSeconds"": 10
                      },
                      {
                        ""armName"": ""counter6"",
                        ""objectName"": ""LogicalDisk"",
                        ""counterName"": ""Disk Reads/sec"",
                        ""instanceName"": ""*"",
                        ""intervalSeconds"": 10
                      },
                      {
                        ""armName"": ""counter7"",
                        ""objectName"": ""LogicalDisk"",
                        ""counterName"": ""Disk Transfers/sec"",
                        ""instanceName"": ""*"",
                        ""intervalSeconds"": 10
                      },
                      {
                        ""armName"": ""counter8"",
                        ""objectName"": ""LogicalDisk"",
                        ""counterName"": ""Disk Write Bytes/sec"",
                        ""instanceName"": ""*"",
                        ""intervalSeconds"": 10
                      },
                      {
                        ""armName"": ""counter9"",
                        ""objectName"": ""LogicalDisk"",
                        ""counterName"": ""Disk Writes/sec"",
                        ""instanceName"": ""*"",
                        ""intervalSeconds"": 10
                      },
                      {
                        ""armName"": ""counter10"",
                        ""objectName"": ""LogicalDisk"",
                        ""counterName"": ""Free Megabytes"",
                        ""instanceName"": ""*"",
                        ""intervalSeconds"": 10
                      },
                      {
                        ""armName"": ""counter11"",
                        ""objectName"": ""Memory"",
                        ""counterName"": ""Available MBytes"",
                        ""instanceName"": ""*"",
                        ""intervalSeconds"": 10
                      },
                      {
                        ""armName"": ""counter12"",
                        ""objectName"": ""Network Adapter"",
                        ""counterName"": ""Bytes Received/sec"",
                        ""instanceName"": ""*"",
                        ""intervalSeconds"": 10
                      },
                      {
                        ""armName"": ""counter13"",
                        ""objectName"": ""Network Adapter"",
                        ""counterName"": ""Bytes Sent/sec"",
                        ""instanceName"": ""*"",
                        ""intervalSeconds"": 10
                      },
                      {
                        ""armName"": ""counter14"",
                        ""objectName"": ""Processor"",
                        ""counterName"": ""% Processor Time"",
                        ""instanceName"": ""*"",
                        ""intervalSeconds"": 10
                      }
                    ],
                    ""linuxDiskArray"": [
                      {
                        ""counterName"": ""% Used Inodes""
                      },
                      {
                        ""counterName"": ""Free Megabytes""
                      },
                      {
                        ""counterName"": ""% Used Space""
                      },
                      {
                        ""counterName"": ""Disk Transfers/sec""
                      },
                      {
                        ""counterName"": ""Disk Reads/sec""
                      },
                      {
                        ""counterName"": ""Disk writes/sec""
                      }
                    ],
                    ""linuxDiskObject"": {
                      ""armResourceName"": ""Disk"",
                      ""objectName"": ""Logical Disk"",
                      ""instanceName"": ""*"",
                      ""intervalSeconds"": 10
                    },
                    ""linuxMemoryArray"": [
                      {
                        ""counterName"": ""Available MBytes Memory""
                      }
                    ],
                    ""linuxMemoryObject"": {
                      ""armResourceName"": ""Memory"",
                      ""objectName"": ""Memory"",
                      ""instanceName"": ""*"",
                      ""intervalSeconds"": 10
                    },
                    ""linuxNetworkArray"": [
                      {
                        ""counterName"": ""Total Bytes Received""
                      },
                      {
                        ""counterName"": ""Total Bytes Transmitted""
                      }
                    ],
                    ""linuxNetworkObject"": {
                      ""armResourceName"": ""Network"",
                      ""objectName"": ""Network"",
                      ""instanceName"": ""*"",
                      ""intervalSeconds"": 10
                    },
                    ""linuxCpuArray"": [
                      {
                        ""counterName"": ""% Processor Time""
                      }
                    ],
                    ""linuxCpuObject"": {
                      ""armResourceName"": ""Processor"",
                      ""objectName"": ""Processor"",
                      ""instanceName"": ""*"",
                      ""intervalSeconds"": 10
                    }
                  },
                  ""batch1"": {
                    ""solutions"": [
                      {
                        ""name"": ""[concat('Security', '(', parameters('workspaceName'), ')')]"",
                        ""marketplaceName"": ""Security""
                      },
                      {
                        ""name"": ""[concat('AgentHealthAssessment', '(', parameters('workspaceName'), ')')]"",
                        ""marketplaceName"": ""AgentHealthAssessment""
                      },
                      {
                        ""name"": ""[concat('ChangeTracking', '(', parameters('workspaceName'), ')')]"",
                        ""marketplaceName"": ""ChangeTracking""
                      },
                      {
                        ""name"": ""[concat('Updates', '(', parameters('workspaceName'), ')')]"",
                        ""marketplaceName"": ""Updates""
                      },
                      {
                        ""name"": ""[concat('AzureActivity', '(', parameters('workspaceName'), ')')]"",
                        ""marketplaceName"": ""AzureActivity""
                      },
                      {
                        ""name"": ""[concat('AzureAutomation', '(', parameters('workspaceName'), ')')]"",
                        ""marketplaceName"": ""AzureAutomation""
                      },
                      {
                        ""name"": ""[concat('ADAssessment', '(', parameters('workspaceName'), ')')]"",
                        ""marketplaceName"": ""ADAssessment""
                      },
                      {
                        ""name"": ""[concat('SQLAssessment', '(', parameters('workspaceName'), ')')]"",
                        ""marketplaceName"": ""SQLAssessment""
                      },
                      {
                        ""name"": ""[concat('VMInsights', '(', parameters('workspaceName'), ')')]"",
                        ""marketplaceName"": ""VMInsights""
                      },
                      {
                        ""name"": ""[concat('ServiceMap', '(', parameters('workspaceName'), ')')]"",
                        ""marketplaceName"": ""ServiceMap""
                      },
                      {
                        ""name"": ""[concat('SecurityInsights', '(', parameters('workspaceName'), ')')]"",
                        ""marketplaceName"": ""SecurityInsights""
                      }
                    ]
                  }
                },
                ""resources"": [
                  {
                    ""apiVersion"": ""2015-11-01-preview"",
                    ""type"": ""Microsoft.OperationalInsights/workspaces/datasources"",
                    ""name"": ""[concat(parameters('workspaceName'), '/LinuxPerfCollection')]"",
                    ""kind"": ""LinuxPerformanceCollection"",
                    ""properties"": {
                      ""state"": ""Enabled""
                    }
                  },
                  {
                    ""apiVersion"": ""2015-11-01-preview"",
                    ""type"": ""Microsoft.OperationalInsights/workspaces/dataSources"",
                    ""name"": ""[concat(parameters('workspaceName'), '/', variables('vmInsightsPerfCounters').linuxDiskObject.armResourceName)]"",
                    ""kind"": ""LinuxPerformanceObject"",
                    ""properties"": {
                      ""performanceCounters"": ""[variables('vmInsightsPerfCounters').linuxDiskArray]"",
                      ""objectName"": ""[variables('vmInsightsPerfCounters').linuxDiskObject.objectName]"",
                      ""instanceName"": ""[variables('vmInsightsPerfCounters').linuxDiskObject.instanceName]"",
                      ""intervalSeconds"": ""[variables('vmInsightsPerfCounters').linuxDiskObject.intervalSeconds]""
                    }
                  },
                  {
                    ""apiVersion"": ""2015-11-01-preview"",
                    ""type"": ""Microsoft.OperationalInsights/workspaces/dataSources"",
                    ""name"": ""[concat(parameters('workspaceName'), '/', variables('vmInsightsPerfCounters').linuxMemoryObject.armResourceName)]"",
                    ""kind"": ""LinuxPerformanceObject"",
                    ""properties"": {
                      ""performanceCounters"": ""[variables('vmInsightsPerfCounters').linuxMemoryArray]"",
                      ""objectName"": ""[variables('vmInsightsPerfCounters').linuxMemoryObject.objectName]"",
                      ""instanceName"": ""[variables('vmInsightsPerfCounters').linuxMemoryObject.instanceName]"",
                      ""intervalSeconds"": ""[variables('vmInsightsPerfCounters').linuxMemoryObject.intervalSeconds]""
                    }
                  },
                  {
                    ""apiVersion"": ""2015-11-01-preview"",
                    ""type"": ""Microsoft.OperationalInsights/workspaces/dataSources"",
                    ""name"": ""[concat(parameters('workspaceName'), '/', variables('vmInsightsPerfCounters').linuxCpuObject.armResourceName)]"",
                    ""kind"": ""LinuxPerformanceObject"",
                    ""properties"": {
                      ""performanceCounters"": ""[variables('vmInsightsPerfCounters').linuxCpuArray]"",
                      ""objectName"": ""[variables('vmInsightsPerfCounters').linuxCpuObject.objectName]"",
                      ""instanceName"": ""[variables('vmInsightsPerfCounters').linuxCpuObject.instanceName]"",
                      ""intervalSeconds"": ""[variables('vmInsightsPerfCounters').linuxCpuObject.intervalSeconds]""
                    }
                  },
                  {
                    ""apiVersion"": ""2015-11-01-preview"",
                    ""type"": ""Microsoft.OperationalInsights/workspaces/dataSources"",
                    ""name"": ""[concat(parameters('workspaceName'), '/', variables('vmInsightsPerfCounters').linuxNetworkObject.armResourceName)]"",
                    ""kind"": ""LinuxPerformanceObject"",
                    ""properties"": {
                      ""performanceCounters"": ""[variables('vmInsightsPerfCounters').linuxNetworkArray]"",
                      ""objectName"": ""[variables('vmInsightsPerfCounters').linuxNetworkObject.objectName]"",
                      ""instanceName"": ""[variables('vmInsightsPerfCounters').linuxNetworkObject.instanceName]"",
                      ""intervalSeconds"": ""[variables('vmInsightsPerfCounters').linuxNetworkObject.intervalSeconds]""
                    }
                  },
                  {
                    ""apiVersion"": ""2015-11-01-preview"",
                    ""type"": ""Microsoft.OperationalInsights/workspaces/dataSources"",
                    ""name"": ""[concat(parameters('workspaceName'), '/', variables('vmInsightsPerfCounters').windowsArray[copyIndex()].armName)]"",
                    ""kind"": ""WindowsPerformanceCounter"",
                    ""copy"": {
                      ""name"": ""counterCopy"",
                      ""count"": ""[length(variables('vmInsightsPerfCounters').windowsArray)]""
                    },
                    ""properties"": {
                      ""objectName"": ""[variables('vmInsightsPerfCounters').windowsArray[copyIndex()].objectName]"",
                      ""instanceName"": ""[variables('vmInsightsPerfCounters').windowsArray[copyIndex()].instanceName]"",
                      ""intervalSeconds"": ""[variables('vmInsightsPerfCounters').windowsArray[copyIndex()].intervalSeconds]"",
                      ""counterName"": ""[variables('vmInsightsPerfCounters').windowsArray[copyIndex()].counterName]""
                    }
                  },
                  {
                    ""apiVersion"": ""2015-11-01-preview"",
                    ""type"": ""Microsoft.OperationsManagement/solutions"",
                    ""name"": ""[concat(variables('batch1').solutions[copyIndex()].Name)]"",
                    ""location"": ""[parameters('workspaceRegion')]"",
                    ""copy"": {
                      ""name"": ""solutionCopy"",
                      ""count"": ""[length(variables('batch1').solutions)]""
                    },
                    ""properties"": {
                      ""workspaceResourceId"": ""[resourceId('Microsoft.OperationalInsights/workspaces/', parameters('workspaceName'))]""
                    },
                    ""plan"": {
                      ""name"": ""[variables('batch1').solutions[copyIndex()].name]"",
                      ""product"": ""[concat('OMSGallery/', variables('batch1').solutions[copyIndex()].marketplaceName)]"",
                      ""promotionCode"": """",
                      ""publisher"": ""Microsoft""
                    }
                  }
                ],
                ""outputs"": {}
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-LA-Config"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-LA-Config""
}"
"Mg";"ESJH";"Deploy the Log Analytics in the subscription";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-log-analytics";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"1 (/providers/microsoft.management/managementgroups/esjh-management/providers/microsoft.authorization/policyassignments/deploy-log-analytics)";"0";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy the Log Analytics in the subscription"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys Log Analytics and Automation account to the subscription where the policy is assigned."",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.3910318Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""workspaceName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""workspaceName"",
          ""description"": ""Provide name for log analytics workspace""
        }
      },
      ""automationAccountName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""automationAccountName"",
          ""description"": ""Provide name for automation account""
        }
      },
      ""workspaceRegion"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""workspaceRegion"",
          ""description"": ""Select Azure region for Log Analytics""
        }
      },
      ""automationRegion"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""automationRegion"",
          ""description"": ""Select Azure region for Automation account""
        }
      },
      ""retentionInDays"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Data retention"",
          ""description"": ""Select data retention (days) for Log Analytics.""
        },
        ""defaultValue"": ""30""
      },
      ""rgName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""rgName"",
          ""description"": ""Provide name for resource group.""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""allOf"": [
          {
            ""field"": ""type"",
            ""equals"": ""Microsoft.Resources/subscriptions""
          }
        ]
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.OperationalInsights/workspaces"",
          ""deploymentScope"": ""Subscription"",
          ""existenceScope"": ""Subscription"",
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""name"",
                ""like"": ""[parameters('workspaceName')]""
              }
            ]
          },
          ""deployment"": {
            ""location"": ""northeurope"",
            ""properties"": {
              ""mode"": ""incremental"",
              ""parameters"": {
                ""rgName"": {
                  ""value"": ""[parameters('rgName')]""
                },
                ""retentionInDays"": {
                  ""value"": ""[parameters('retentionInDays')]""
                },
                ""workspaceName"": {
                  ""value"": ""[parameters('workspaceName')]""
                },
                ""workspaceRegion"": {
                  ""value"": ""[parameters('workspaceRegion')]""
                },
                ""automationAccountName"": {
                  ""value"": ""[parameters('automationAccountName')]""
                },
                ""automationRegion"": {
                  ""value"": ""[parameters('automationRegion')]""
                }
              },
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""rgName"": {
                    ""type"": ""string""
                  },
                  ""workspaceName"": {
                    ""type"": ""string""
                  },
                  ""workspaceRegion"": {
                    ""type"": ""string""
                  },
                  ""automationAccountName"": {
                    ""type"": ""string""
                  },
                  ""automationRegion"": {
                    ""type"": ""string""
                  },
                  ""retentionInDays"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Resources/resourceGroups"",
                    ""apiVersion"": ""2018-05-01"",
                    ""name"": ""[parameters('rgName')]"",
                    ""location"": ""[deployment().location]"",
                    ""properties"": {}
                  },
                  {
                    ""type"": ""Microsoft.Resources/deployments"",
                    ""apiVersion"": ""2018-05-01"",
                    ""name"": ""log-analytics"",
                    ""resourceGroup"": ""[parameters('rgName')]"",
                    ""dependsOn"": [
                      ""[resourceId('Microsoft.Resources/resourceGroups/', parameters('rgName'))]""
                    ],
                    ""properties"": {
                      ""mode"": ""Incremental"",
                      ""template"": {
                        ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json"",
                        ""contentVersion"": ""1.0.0.0"",
                        ""parameters"": {},
                        ""variables"": {},
                        ""resources"": [
                          {
                            ""apiversion"": ""2015-10-31"",
                            ""location"": ""[parameters('AutomationRegion')]"",
                            ""name"": ""[parameters('AutomationAccountName')]"",
                            ""type"": ""Microsoft.Automation/automationAccounts"",
                            ""comments"": ""Automation account for "",
                            ""properties"": {
                              ""sku"": {
                                ""name"": ""OMS""
                              }
                            }
                          },
                          {
                            ""apiVersion"": ""2017-03-15-preview"",
                            ""location"": ""[parameters('workspaceRegion')]"",
                            ""name"": ""[parameters('workspaceName')]"",
                            ""type"": ""Microsoft.OperationalInsights/workspaces"",
                            ""properties"": {
                              ""sku"": {
                                ""name"": ""pernode""
                              },
                              ""enableLogAccessUsingOnlyResourcePermissions"": true,
                              ""retentionInDays"": ""[int(parameters('retentionInDays'))]""
                            },
                            ""resources"": [
                              {
                                ""name"": ""Automation"",
                                ""type"": ""linkedServices"",
                                ""apiVersion"": ""2015-11-01-preview"",
                                ""dependsOn"": [
                                  ""[resourceId('Microsoft.OperationalInsights/workspaces/', parameters('workspaceName'))]"",
                                  ""[resourceId('Microsoft.Automation/automationAccounts/', parameters('AutomationAccountName'))]""
                                ],
                                ""properties"": {
                                  ""resourceId"": ""[concat(subscription().id, '/resourceGroups/', parameters('rgName'), '/providers/Microsoft.Automation/automationAccounts/', parameters('AutomationAccountName'))]""
                                }
                              }
                            ]
                          }
                        ],
                        ""outputs"": {}
                      }
                    }
                  }
                ],
                ""outputs"": {}
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Log-Analytics"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Log-Analytics""
}"
"Mg";"ESJH";"Deploys NSG flow logs and traffic analytics";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-nsg-flowlogs";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Monitoring";"Monitoring Contributor, Log Analytics Contributor";"0";"0";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploys NSG flow logs and traffic analytics"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploys NSG flow logs and traffic analytics to a storageaccountid with a specfied retention period."",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Monitoring"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.4979325Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""retention"": {
        ""type"": ""Integer"",
        ""metadata"": {
          ""displayName"": ""Retention""
        },
        ""defaultValue"": 5
      },
      ""storageAccountResourceId"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Storage Account Resource Id"",
          ""strongType"": ""Microsoft.Storage/storageAccounts""
        }
      },
      ""trafficAnalyticsInterval"": {
        ""type"": ""Integer"",
        ""metadata"": {
          ""displayName"": ""Traffic Analytics processing interval mins (10/60)""
        },
        ""defaultValue"": 60
      },
      ""flowAnalyticsEnabled"": {
        ""type"": ""Boolean"",
        ""metadata"": {
          ""displayName"": ""Enable Traffic Analytics""
        },
        ""defaultValue"": false
      },
      ""logAnalytics"": {
        ""type"": ""String"",
        ""metadata"": {
          ""strongType"": ""omsWorkspace"",
          ""displayName"": ""Resource ID of Log Analytics workspace"",
          ""description"": ""Select Log Analytics workspace from dropdown list. If this workspace is outside of the scope of the assignment you must manually grant 'Log Analytics Contributor' permissions (or similar) to the policy assignment's principal ID.""
        },
        ""defaultValue"": """"
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.Network/networkSecurityGroups""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Network/networkWatchers/flowLogs"",
          ""roleDefinitionIds"": [
            ""/providers/microsoft.authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa"",
            ""/providers/microsoft.authorization/roleDefinitions/92aaf0da-9dab-42b6-94a3-d43ce8d16293""
          ],
          ""resourceGroupName"": ""NetworkWatcherRG"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Network/networkWatchers/flowLogs/enabled"",
                ""equals"": ""true""
              },
              {
                ""field"": ""Microsoft.Network/networkWatchers/flowLogs/flowAnalyticsConfiguration.networkWatcherFlowAnalyticsConfiguration.enabled"",
                ""equals"": ""[parameters('flowAnalyticsEnabled')]""
              }
            ]
          },
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""parameters"": {
                ""networkSecurityGroupName"": {
                  ""value"": ""[field('name')]""
                },
                ""resourceGroupName"": {
                  ""value"": ""[resourceGroup().name]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""storageAccountResourceId"": {
                  ""value"": ""[parameters('storageAccountResourceId')]""
                },
                ""retention"": {
                  ""value"": ""[parameters('retention')]""
                },
                ""flowAnalyticsEnabled"": {
                  ""value"": ""[parameters('flowAnalyticsEnabled')]""
                },
                ""trafficAnalyticsInterval"": {
                  ""value"": ""[parameters('trafficAnalyticsInterval')]""
                },
                ""logAnalytics"": {
                  ""value"": ""[parameters('logAnalytics')]""
                }
              },
              ""template"": {
                ""$schema"": ""https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""networkSecurityGroupName"": {
                    ""type"": ""string""
                  },
                  ""resourceGroupName"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""storageAccountResourceId"": {
                    ""type"": ""string""
                  },
                  ""retention"": {
                    ""type"": ""int""
                  },
                  ""flowAnalyticsEnabled"": {
                    ""type"": ""bool""
                  },
                  ""trafficAnalyticsInterval"": {
                    ""type"": ""int""
                  },
                  ""logAnalytics"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Network/networkWatchers/flowLogs"",
                    ""apiVersion"": ""2020-05-01"",
                    ""name"": ""[take(concat('NetworkWatcher_', toLower(parameters('location')),  '/', parameters('networkSecurityGroupName'), '-', parameters('resourceGroupName'), '-flowlog' ), 80)]"",
                    ""location"": ""[parameters('location')]"",
                    ""properties"": {
                      ""targetResourceId"": ""[resourceId(parameters('resourceGroupName'), 'Microsoft.Network/networkSecurityGroups', parameters('networkSecurityGroupName'))]"",
                      ""storageId"": ""[parameters('storageAccountResourceId')]"",
                      ""enabled"": true,
                      ""retentionPolicy"": {
                        ""enabled"": true,
                        ""days"": ""[parameters('retention')]""
                      },
                      ""format"": {
                        ""type"": ""JSON"",
                        ""version"": 2
                      },
                      ""flowAnalyticsConfiguration"": {
                        ""networkWatcherFlowAnalyticsConfiguration"": {
                          ""enabled"": ""[bool(parameters('flowAnalyticsEnabled'))]"",
                          ""trafficAnalyticsInterval"": ""[parameters('trafficAnalyticsInterval')]"",
                          ""workspaceId"": ""[if(not(empty(parameters('logAnalytics'))), reference(parameters('logAnalytics'), '2020-03-01-preview', 'Full').properties.customerId, json('null')) ]"",
                          ""workspaceRegion"": ""[if(not(empty(parameters('logAnalytics'))), reference(parameters('logAnalytics'), '2020-03-01-preview', 'Full').location, json('null')) ]"",
                          ""workspaceResourceId"": ""[if(not(empty(parameters('logAnalytics'))), parameters('logAnalytics'), json('null'))]""
                        }
                      }
                    }
                  }
                ],
                ""outputs"": {}
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Nsg-FlowLogs"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Nsg-FlowLogs""
}"
"Mg";"ESJH";"Deploy SQL database auditing settings";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-sql-auditingsettings";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"SQL";"SQL Security Manager";"0";"1 (Deploy SQL Database built-in SQL security configuration (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-sql-security)";"2021-01-10 20:57:37";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy SQL database auditing settings"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploy auditing settings to SQL Database when it not exist in the deployment"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""SQL"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:37.9782455Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.Sql/servers/databases""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Sql/servers/databases/auditingSettings"",
          ""name"": ""default"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Sql/servers/databases/auditingSettings/state"",
                ""equals"": ""enabled""
              },
              {
                ""field"": ""Microsoft.Sql/servers/databases/auditingSettings/isAzureMonitorTargetEnabled"",
                ""equals"": ""true""
              }
            ]
          },
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""sqlServerName"": {
                    ""type"": ""string""
                  },
                  ""sqlServerDataBaseName"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""name"": ""[concat( parameters('sqlServerName'),'/',parameters('sqlServerDataBaseName'),'/default')]"",
                    ""type"": ""Microsoft.Sql/servers/databases/auditingSettings"",
                    ""apiVersion"": ""2017-03-01-preview"",
                    ""properties"": {
                      ""state"": ""enabled"",
                      ""auditActionsAndGroups"": [
                        ""BATCH_COMPLETED_GROUP"",
                        ""DATABASE_OBJECT_CHANGE_GROUP"",
                        ""SCHEMA_OBJECT_CHANGE_GROUP"",
                        ""BACKUP_RESTORE_GROUP"",
                        ""APPLICATION_ROLE_CHANGE_PASSWORD_GROUP"",
                        ""DATABASE_PRINCIPAL_CHANGE_GROUP"",
                        ""DATABASE_PRINCIPAL_IMPERSONATION_GROUP"",
                        ""DATABASE_ROLE_MEMBER_CHANGE_GROUP"",
                        ""USER_CHANGE_PASSWORD_GROUP"",
                        ""DATABASE_OBJECT_OWNERSHIP_CHANGE_GROUP"",
                        ""DATABASE_OBJECT_PERMISSION_CHANGE_GROUP"",
                        ""DATABASE_PERMISSION_CHANGE_GROUP"",
                        ""SCHEMA_OBJECT_PERMISSION_CHANGE_GROUP"",
                        ""SUCCESSFUL_DATABASE_AUTHENTICATION_GROUP"",
                        ""FAILED_DATABASE_AUTHENTICATION_GROUP""
                      ],
                      ""isAzureMonitorTargetEnabled"": true
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""sqlServerName"": {
                  ""value"": ""[first(split(field('fullname'),'/'))]""
                },
                ""sqlServerDataBaseName"": {
                  ""value"": ""[field('name')]""
                }
              }
            }
          },
          ""roleDefinitionIds"": [
            ""/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3""
          ]
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-AuditingSettings"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Sql-AuditingSettings""
}"
"Mg";"ESJH";"Deploy SQL Database security Alert Policies configuration with email admin accounts";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-sql-securityalertpolicies";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"SQL";"SQL Security Manager";"0";"1 (Deploy SQL Database built-in SQL security configuration (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-sql-security)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy SQL Database security Alert Policies configuration with email admin accounts"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploy the security Alert Policies configuration with email admin accounts when it not exist in current configuration"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""SQL"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.4946469Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.Sql/servers/databases""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Sql/servers/databases/securityAlertPolicies"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Sql/servers/databases/securityAlertPolicies/state"",
                ""equals"": ""Enabled""
              }
            ]
          },
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""sqlServerName"": {
                    ""type"": ""string""
                  },
                  ""sqlServerDataBaseName"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""name"": ""[concat(parameters('sqlServerName'),'/',parameters('sqlServerDataBaseName'),'/default')]"",
                    ""type"": ""Microsoft.Sql/servers/databases/securityAlertPolicies"",
                    ""apiVersion"": ""2018-06-01-preview"",
                    ""properties"": {
                      ""state"": ""Enabled"",
                      ""disabledAlerts"": [
                        """"
                      ],
                      ""emailAddresses"": [
                        ""admin@contoso.com""
                      ],
                      ""emailAccountAdmins"": true,
                      ""storageEndpoint"": null,
                      ""storageAccountAccessKey"": """",
                      ""retentionDays"": 0
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""sqlServerName"": {
                  ""value"": ""[first(split(field('fullname'),'/'))]""
                },
                ""sqlServerDataBaseName"": {
                  ""value"": ""[field('name')]""
                }
              }
            }
          },
          ""roleDefinitionIds"": [
            ""/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3""
          ]
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-SecurityAlertPolicies"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Sql-SecurityAlertPolicies""
}"
"Mg";"ESJH";"Deploy SQL Database Transparent Data Encryption ";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-sql-tde";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"SQL";"SQL Security Manager";"0";"1 (Deploy SQL Database built-in SQL security configuration (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-sql-security)";"2021-01-10 20:57:37";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy SQL Database Transparent Data Encryption "",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploy the Transparent Data Encryption when it is not enabled in the deployment"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""SQL"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:37.8987432Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.Sql/servers/databases""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Sql/servers/databases/transparentDataEncryption"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Sql/transparentDataEncryption.status"",
                ""equals"": ""Enabled""
              }
            ]
          },
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""sqlServerName"": {
                    ""type"": ""string""
                  },
                  ""sqlServerDataBaseName"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""name"": ""[concat( parameters('sqlServerName'),'/',parameters('sqlServerDataBaseName'),'/current')]"",
                    ""type"": ""Microsoft.Sql/servers/databases/transparentDataEncryption"",
                    ""apiVersion"": ""2014-04-01"",
                    ""properties"": {
                      ""status"": ""Enabled""
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""sqlServerName"": {
                  ""value"": ""[first(split(field('fullname'),'/'))]""
                },
                ""sqlServerDataBaseName"": {
                  ""value"": ""[field('name')]""
                }
              }
            }
          },
          ""roleDefinitionIds"": [
            ""/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3""
          ]
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-Tde"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Sql-Tde""
}"
"Mg";"ESJH";"Deploy SQL Database vulnerability Assessments";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-sql-vulnerabilityassessments";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"SQL";"SQL Security Manager, Monitoring Contributor";"0";"1 (Deploy SQL Database built-in SQL security configuration (/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policysetdefinitions/deploy-sql-security)";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy SQL Database vulnerability Assessments"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploy SQL Database vulnerability Assessments when it not exist in the deployment. To the specific  storage account in the parameters"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""SQL"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.4646364Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""vulnerabilityAssessmentsEmail"": {
        ""type"": ""String"",
        ""metadata"": {
          ""description"": ""The email address to send alerts"",
          ""displayName"": ""The email address to send alerts""
        }
      },
      ""vulnerabilityAssessmentsStorageID"": {
        ""type"": ""String"",
        ""metadata"": {
          ""description"": ""The storage account to store assessments"",
          ""displayName"": ""The storage account to store assessments""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""field"": ""type"",
        ""equals"": ""Microsoft.Sql/servers/databases""
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Sql/servers/databases/vulnerabilityAssessments"",
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Sql/servers/databases/vulnerabilityAssessments/recurringScans.emails"",
                ""equals"": ""[parameters('vulnerabilityAssessmentsEmail')]""
              },
              {
                ""field"": ""Microsoft.Sql/servers/databases/vulnerabilityAssessments/recurringScans.isEnabled"",
                ""equals"": true
              }
            ]
          },
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""sqlServerName"": {
                    ""type"": ""string""
                  },
                  ""sqlServerDataBaseName"": {
                    ""type"": ""string""
                  },
                  ""vulnerabilityAssessmentsEmail"": {
                    ""type"": ""string""
                  },
                  ""vulnerabilityAssessmentsStorageID"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""name"": ""[concat(parameters('sqlServerName'),'/',parameters('sqlServerDataBaseName'),'/default')]"",
                    ""type"": ""Microsoft.Sql/servers/databases/vulnerabilityAssessments"",
                    ""apiVersion"": ""2017-03-01-preview"",
                    ""properties"": {
                      ""storageContainerPath"": ""[concat('https://', last( split(parameters('vulnerabilityAssessmentsStorageID') ,  '/') ) , '.blob.core.windows.net/vulneraabilitylogs')]"",
                      ""storageAccountAccessKey"": ""[listkeys(parameters('vulnerabilityAssessmentsStorageID'), providers('Microsoft.Storage', 'storageAccounts').apiVersions[0]).keys[0].value]"",
                      ""recurringScans"": {
                        ""isEnabled"": true,
                        ""emailSubscriptionAdmins"": false,
                        ""emails"": [
                          ""[parameters('vulnerabilityAssessmentsEmail')]""
                        ]
                      }
                    }
                  }
                ],
                ""outputs"": {}
              },
              ""parameters"": {
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""sqlServerName"": {
                  ""value"": ""[first(split(field('fullname'),'/'))]""
                },
                ""sqlServerDataBaseName"": {
                  ""value"": ""[field('name')]""
                },
                ""vulnerabilityAssessmentsEmail"": {
                  ""value"": ""[parameters('vulnerabilityAssessmentsEmail')]""
                },
                ""vulnerabilityAssessmentsStorageID"": {
                  ""value"": ""[parameters('vulnerabilityAssessmentsStorageID')]""
                }
              }
            }
          },
          ""roleDefinitionIds"": [
            ""/providers/Microsoft.Authorization/roleDefinitions/056cd41c-7e88-42e1-933e-88ba6a50c9c3"",
            ""/providers/Microsoft.Authorization/roleDefinitions/749f88d5-cbae-40b8-bcfc-e573ddc772fa""
          ]
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Sql-vulnerabilityAssessments"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Sql-vulnerabilityAssessments""
}"
"Mg";"ESJH";"Deploy Virtual Hub network with Virtual Wan and Gateway and Firewall configured.";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-vhub";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Network";"Network Contributor";"0";"0";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Virtual Hub network with Virtual Wan and Gateway and Firewall configured."",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploy Virtual Hub network with Virtual Wan and Gateway and Firewall configured in the desired region. "",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Network"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.4945673Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""vwanname"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""vwanname"",
          ""description"": ""Name of the Virtual WAN""
        }
      },
      ""vHubName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""vHubName"",
          ""description"": ""Name of the vHUB""
        },
        ""defaultValue"": """"
      },
      ""vHUB"": {
        ""type"": ""Object"",
        ""metadata"": {
          ""displayName"": ""vHUB"",
          ""description"": ""Object describing Virtual WAN vHUB""
        }
      },
      ""vpngw"": {
        ""type"": ""Object"",
        ""metadata"": {
          ""displayName"": ""vpngw"",
          ""description"": ""Object describing VPN gateway""
        },
        ""defaultValue"": {}
      },
      ""ergw"": {
        ""type"": ""Object"",
        ""metadata"": {
          ""displayName"": ""ergw"",
          ""description"": ""Object describing ExpressRoute gateway""
        },
        ""defaultValue"": {}
      },
      ""azfw"": {
        ""type"": ""Object"",
        ""metadata"": {
          ""displayName"": ""azfw"",
          ""description"": ""Object describing the Azure Firewall in vHUB""
        },
        ""defaultValue"": {}
      },
      ""rgName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""rgName"",
          ""description"": ""Provide name for resource group.""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""allOf"": [
          {
            ""field"": ""type"",
            ""equals"": ""Microsoft.Resources/subscriptions""
          }
        ]
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Network/virtualHubs"",
          ""name"": ""[parameters('vHubName')]"",
          ""deploymentScope"": ""Subscription"",
          ""existenceScope"": ""ResourceGroup"",
          ""ResourceGroupName"": ""[parameters('rgName')]"",
          ""roleDefinitionIds"": [
            ""/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7""
          ],
          ""deployment"": {
            ""location"": ""northeurope"",
            ""properties"": {
              ""mode"": ""incremental"",
              ""parameters"": {
                ""rgName"": {
                  ""value"": ""[parameters('rgName')]""
                },
                ""vwanname"": {
                  ""value"": ""[parameters('vwanname')]""
                },
                ""vHUB"": {
                  ""value"": ""[parameters('vHUB')]""
                },
                ""vpngw"": {
                  ""value"": ""[parameters('vpngw')]""
                },
                ""ergw"": {
                  ""value"": ""[parameters('ergw')]""
                },
                ""azfw"": {
                  ""value"": ""[parameters('azfw')]""
                },
                ""vHUBName"": {
                  ""value"": ""[parameters('vHUBName')]""
                }
              },
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""vwanname"": {
                    ""type"": ""string"",
                    ""metadata"": {
                      ""description"": ""Name of the Virtual WAN""
                    }
                  },
                  ""vHUB"": {
                    ""type"": ""object"",
                    ""metadata"": {
                      ""description"": ""Object describing Virtual WAN vHUB""
                    }
                  },
                  ""vpngw"": {
                    ""type"": ""object"",
                    ""defaultValue"": {},
                    ""metadata"": {
                      ""description"": ""Object describing VPN gateway""
                    }
                  },
                  ""ergw"": {
                    ""type"": ""object"",
                    ""defaultValue"": {},
                    ""metadata"": {
                      ""description"": ""Object describing ExpressRoute gateway""
                    }
                  },
                  ""azfw"": {
                    ""type"": ""object"",
                    ""defaultValue"": {},
                    ""metadata"": {
                      ""description"": ""Object describing the Azure Firewall in vHUB""
                    }
                  },
                  ""rgName"": {
                    ""type"": ""String"",
                    ""metadata"": {
                      ""displayName"": ""rgName"",
                      ""description"": ""Provide name for resource group.""
                    }
                  },
                  ""vHUBName"": {
                    ""type"": ""String"",
                    ""metadata"": {
                      ""displayName"": ""vHUBName"",
                      ""description"": ""Name of the vHUB""
                    }
                  }
                },
                ""variables"": {
                  ""vhubsku"": ""Standard"",
                  ""vwanresourceid"": ""[concat(subscription().id,'/resourceGroups/',parameters('rgName'),'/providers/Microsoft.Network/virtualWans/',parameters('vwanname'))]"",
                  ""vwanhub"": ""[concat(subscription().id,'/resourceGroups/',parameters('rgName'),'/providers/Microsoft.Network/virtualHubs/',parameters('vHUBName'))]""
                },
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Resources/resourceGroups"",
                    ""apiVersion"": ""2018-05-01"",
                    ""name"": ""[parameters('rgName')]"",
                    ""location"": ""[deployment().location]"",
                    ""properties"": {}
                  },
                  {
                    ""type"": ""Microsoft.Resources/deployments"",
                    ""apiVersion"": ""2018-05-01"",
                    ""name"": ""[concat('vHUBdeploy-',parameters('vHUB').location)]"",
                    ""resourceGroup"": ""[parameters('rgName')]"",
                    ""dependsOn"": [
                      ""[resourceId('Microsoft.Resources/resourceGroups/', parameters('rgName'))]""
                    ],
                    ""properties"": {
                      ""mode"": ""Incremental"",
                      ""template"": {
                        ""$schema"": ""https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#"",
                        ""contentVersion"": ""1.0.0.0"",
                        ""parameters"": {},
                        ""variables"": {},
                        ""resources"": [
                          {
                            ""type"": ""Microsoft.Network/virtualHubs"",
                            ""apiVersion"": ""2020-05-01"",
                            ""location"": ""[parameters('vHUB').location]"",
                            ""name"": ""[parameters('vHUBname')]"",
                            ""properties"": {
                              ""virtualWan"": {
                                ""id"": ""[variables('vwanresourceid')]""
                              },
                              ""addressPrefix"": ""[parameters('vHUB').addressPrefix]"",
                              ""sku"": ""[variables('vhubsku')]""
                            }
                          }
                        ]
                      }
                    }
                  },
                  {
                    ""type"": ""Microsoft.Resources/deployments"",
                    ""apiVersion"": ""2018-05-01"",
                    ""condition"": ""[greater(length(parameters('vpngw')),0)]"",
                    ""resourceGroup"": ""[parameters('rgName')]"",
                    ""dependsOn"": [
                      ""[concat('vHUBdeploy-',parameters('vHUB').location)]""
                    ],
                    ""name"": ""[concat(parameters('vHUBName'),'-vpngw')]"",
                    ""properties"": {
                      ""mode"": ""Incremental"",
                      ""template"": {
                        ""$schema"": ""https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#"",
                        ""contentVersion"": ""1.0.0.0"",
                        ""parameters"": {},
                        ""variables"": {},
                        ""resources"": [
                          {
                            ""type"": ""Microsoft.Network/vpnGateways"",
                            ""apiVersion"": ""2020-05-01"",
                            ""location"": ""[parameters('vHUB').location]"",
                            ""name"": ""[parameters('vpngw').name]"",
                            ""properties"": {
                              ""virtualHub"": {
                                ""id"": ""[variables('vwanhub')]""
                              },
                              ""bgpSettings"": ""[parameters('vpngw').bgpSettings]"",
                              ""vpnGatewayScaleUnit"": ""[parameters('vpngw').vpnGatewayScaleUnit]""
                            }
                          }
                        ]
                      }
                    }
                  },
                  {
                    ""type"": ""Microsoft.Resources/deployments"",
                    ""apiVersion"": ""2018-05-01"",
                    ""condition"": ""[greater(length(parameters('ergw')),0)]"",
                    ""resourceGroup"": ""[parameters('rgName')]"",
                    ""dependsOn"": [
                      ""[concat('vHUBdeploy-',parameters('vHUB').location)]""
                    ],
                    ""name"": ""[concat(parameters('vHUBName'),'-ergw')]"",
                    ""properties"": {
                      ""mode"": ""Incremental"",
                      ""template"": {
                        ""$schema"": ""https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#"",
                        ""contentVersion"": ""1.0.0.0"",
                        ""parameters"": {},
                        ""variables"": {},
                        ""resources"": [
                          {
                            ""type"": ""Microsoft.Network/expressRouteGateways"",
                            ""apiVersion"": ""2020-05-01"",
                            ""location"": ""[parameters('vHUB').location]"",
                            ""name"": ""[parameters('ergw').name]"",
                            ""properties"": {
                              ""virtualHub"": {
                                ""id"": ""[variables('vwanhub')]""
                              },
                              ""autoScaleConfiguration"": ""[parameters('ergw').autoScaleConfiguration]""
                            }
                          }
                        ]
                      }
                    }
                  }
                ]
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-vHUB"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-vHUB""
}"
"Mg";"ESJH";"Deploy spoke network with configuration to hub network based on ipam configuration object";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-vnet";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Network";"Network Contributor";"0";"0";"2021-01-10 20:57:36";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy spoke network with configuration to hub network based on ipam configuration object"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploy spoke network with configuration to hub network based on ipam configuration object"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Network"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:36.0620342Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""ipam"": {
        ""type"": ""Array"",
        ""metadata"": {
          ""displayName"": ""ipam"",
          ""description"": null
        },
        ""defaultValue"": []
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""allOf"": [
          {
            ""field"": ""type"",
            ""equals"": ""Microsoft.Resources/subscriptions""
          }
        ]
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Resources/resourceGroups"",
          ""deploymentScope"": ""Subscription"",
          ""existenceScope"": ""Subscription"",
          ""roleDefinitionIds"": [
            ""/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7""
          ],
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""type"",
                ""equals"": ""Microsoft.Resources/subscriptions/resourceGroups""
              },
              {
                ""field"": ""name"",
                ""like"": ""[concat(subscription().displayName, '-network')]""
              }
            ]
          },
          ""deployment"": {
            ""location"": ""northeurope"",
            ""properties"": {
              ""mode"": ""incremental"",
              ""parameters"": {
                ""ipam"": {
                  ""value"": ""[parameters('ipam')]"",
                  ""defaultValue"": []
                }
              },
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""ipam"": {
                    ""defaultValue"": [
                      {
                        ""name"": ""bu1-weu-msx3-vNet1"",
                        ""location"": ""westeurope"",
                        ""virtualNetworks"": {
                          ""properties"": {
                            ""addressSpace"": {
                              ""addressPrefixes"": [
                                ""10.51.217.0/24""
                              ]
                            }
                          }
                        },
                        ""networkSecurityGroups"": {
                          ""properties"": {
                            ""securityRules"": []
                          }
                        },
                        ""routeTables"": {
                          ""properties"": {
                            ""routes"": []
                          }
                        },
                        ""hubVirtualNetworkConnection"": {
                          ""vWanVhubResourceId"": ""/subscriptions/99c2838f-a548-4884-a6e2-38c1f8fb4c0b/resourceGroups/contoso-global-vwan/providers/Microsoft.Network/virtualHubs/contoso-vhub-weu"",
                          ""properties"": {
                            ""allowHubToRemoteVnetTransit"": true,
                            ""allowRemoteVnetToUseHubVnetGateways"": false,
                            ""enableInternetSecurity"": true
                          }
                        }
                      }
                    ],
                    ""type"": ""Array""
                  }
                },
                ""variables"": {
                  ""vNetRgName"": ""[concat(subscription().displayName, '-network')]"",
                  ""vNetName"": ""[concat(subscription().displayName, '-vNet')]"",
                  ""vNetSubId"": ""[subscription().subscriptionId]""
                },
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Resources/deployments"",
                    ""apiVersion"": ""2020-06-01"",
                    ""name"": ""[concat('es-ipam-',subscription().displayName,'-RG-',copyIndex())]"",
                    ""location"": ""[parameters('ipam')[copyIndex()].location]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""mode"": ""Incremental"",
                      ""template"": {
                        ""$schema"": ""https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                        ""contentVersion"": ""1.0.0.0"",
                        ""parameters"": {},
                        ""variables"": {},
                        ""resources"": [
                          {
                            ""type"": ""Microsoft.Resources/resourceGroups"",
                            ""apiVersion"": ""2020-06-01"",
                            ""name"": ""[variables('vNetRgName')]"",
                            ""location"": ""[parameters('ipam')[copyIndex()].location]"",
                            ""properties"": {}
                          },
                          {
                            ""type"": ""Microsoft.Resources/resourceGroups"",
                            ""apiVersion"": ""2020-06-01"",
                            ""name"": ""NetworkWatcherRG"",
                            ""location"": ""[parameters('ipam')[copyIndex()].location]"",
                            ""properties"": {}
                          }
                        ],
                        ""outputs"": {}
                      }
                    },
                    ""copy"": {
                      ""name"": ""ipam-rg-loop"",
                      ""count"": ""[length(parameters('ipam'))]""
                    },
                    ""condition"": ""[if(and(not(empty(parameters('ipam'))), equals(toLower(parameters('ipam')[copyIndex()].name),toLower(variables('vNetName')))),bool('true'),bool('false'))]""
                  },
                  {
                    ""type"": ""Microsoft.Resources/deployments"",
                    ""apiVersion"": ""2020-06-01"",
                    ""name"": ""[concat('es-ipam-',subscription().displayName,'-nsg-udr-vnet-hub-vwan-peering-',copyIndex())]"",
                    ""dependsOn"": [
                      ""[concat('es-ipam-',subscription().displayName,'-RG-',copyIndex())]""
                    ],
                    ""properties"": {
                      ""mode"": ""Incremental"",
                      ""template"": {
                        ""$schema"": ""https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                        ""contentVersion"": ""1.0.0.0"",
                        ""parameters"": {},
                        ""variables"": {},
                        ""resources"": [
                          {
                            ""condition"": ""[contains(parameters('ipam')[copyIndex()],'networkSecurityGroups')]"",
                            ""apiVersion"": ""2020-05-01"",
                            ""type"": ""Microsoft.Network/networkSecurityGroups"",
                            ""name"": ""[concat(subscription().displayName, '-nsg')]"",
                            ""location"": ""[parameters('ipam')[copyIndex()].location]"",
                            ""properties"": ""[if(contains(parameters('ipam')[copyIndex()],'networkSecurityGroups'),parameters('ipam')[copyIndex()].networkSecurityGroups.properties,json('null'))]""
                          },
                          {
                            ""condition"": ""[contains(parameters('ipam')[copyIndex()],'routeTables')]"",
                            ""apiVersion"": ""2020-05-01"",
                            ""type"": ""Microsoft.Network/routeTables"",
                            ""name"": ""[concat(subscription().displayName, '-udr')]"",
                            ""location"": ""[parameters('ipam')[copyIndex()].location]"",
                            ""properties"": ""[if(contains(parameters('ipam')[copyIndex()],'routeTables'),parameters('ipam')[copyIndex()].routeTables.properties,json('null'))]""
                          },
                          {
                            ""condition"": ""[contains(parameters('ipam')[copyIndex()],'virtualNetworks')]"",
                            ""type"": ""Microsoft.Network/virtualNetworks"",
                            ""apiVersion"": ""2020-05-01"",
                            ""name"": ""[concat(subscription().displayName, '-vnet')]"",
                            ""location"": ""[parameters('ipam')[copyIndex()].location]"",
                            ""dependsOn"": [
                              ""[concat(subscription().displayName, '-nsg')]"",
                              ""[concat(subscription().displayName, '-udr')]""
                            ],
                            ""properties"": ""[if(contains(parameters('ipam')[copyIndex()],'virtualNetworks'),parameters('ipam')[copyIndex()].virtualNetworks.properties,json('null'))]""
                          },
                          {
                            ""condition"": ""[contains(parameters('ipam')[copyIndex()],'virtualNetworkPeerings')]"",
                            ""type"": ""Microsoft.Network/virtualNetworks/virtualNetworkPeerings"",
                            ""apiVersion"": ""2020-05-01"",
                            ""name"": ""[concat(variables('vNetName'), '/peerToHub')]"",
                            ""dependsOn"": [
                              ""[concat(subscription().displayName, '-vnet')]""
                            ],
                            ""properties"": ""[if(contains(parameters('ipam')[copyIndex()],'virtualNetworkPeerings'),parameters('ipam')[copyIndex()].virtualNetworkPeerings.properties,json('null'))]""
                          },
                          {
                            ""condition"": ""[and(contains(parameters('ipam')[copyIndex()],'virtualNetworks'),contains(parameters('ipam')[copyIndex()],'hubVirtualNetworkConnection'),contains(parameters('ipam')[copyIndex()].hubVirtualNetworkConnection,'vWanVhubResourceId'))]"",
                            ""type"": ""Microsoft.Resources/deployments"",
                            ""apiVersion"": ""2020-06-01"",
                            ""name"": ""[concat('es-ipam-vWan-',subscription().displayName,'-peering-',copyIndex())]"",
                            ""subscriptionId"": ""[if(and(contains(parameters('ipam')[copyIndex()],'hubVirtualNetworkConnection'),contains(parameters('ipam')[copyIndex()].hubVirtualNetworkConnection,'vWanVhubResourceId')),split(parameters('ipam')[copyIndex()].hubVirtualNetworkConnection.vWanVhubResourceId,'/')[2],json('null'))]"",
                            ""resourceGroup"": ""[if(and(contains(parameters('ipam')[copyIndex()],'hubVirtualNetworkConnection'),contains(parameters('ipam')[copyIndex()].hubVirtualNetworkConnection,'vWanVhubResourceId')),split(parameters('ipam')[copyIndex()].hubVirtualNetworkConnection.vWanVhubResourceId,'/')[4],json('null'))]"",
                            ""dependsOn"": [
                              ""[concat(subscription().displayName, '-vnet')]""
                            ],
                            ""properties"": {
                              ""mode"": ""Incremental"",
                              ""expressionEvaluationOptions"": {
                                ""scope"": ""inner""
                              },
                              ""template"": {
                                ""$schema"": ""https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                                ""contentVersion"": ""1.0.0.0"",
                                ""parameters"": {
                                  ""remoteVirtualNetwork"": {
                                    ""type"": ""string""
                                  },
                                  ""vWanVhubName"": {
                                    ""Type"": ""string"",
                                    ""defaultValue"": """"
                                  },
                                  ""allowHubToRemoteVnetTransit"": {
                                    ""Type"": ""bool"",
                                    ""defaultValue"": true
                                  },
                                  ""allowRemoteVnetToUseHubVnetGateways"": {
                                    ""Type"": ""bool"",
                                    ""defaultValue"": false
                                  },
                                  ""enableInternetSecurity"": {
                                    ""Type"": ""bool"",
                                    ""defaultValue"": true
                                  }
                                },
                                ""variables"": {},
                                ""resources"": [
                                  {
                                    ""type"": ""Microsoft.Network/virtualHubs/hubVirtualNetworkConnections"",
                                    ""apiVersion"": ""2020-05-01"",
                                    ""name"": ""[[concat(parameters('vWanVhubName'),'/',last(split(parameters('remoteVirtualNetwork'),'/')))]"",
                                    ""properties"": {
                                      ""remoteVirtualNetwork"": {
                                        ""id"": ""[[parameters('remoteVirtualNetwork')]""
                                      },
                                      ""allowHubToRemoteVnetTransit"": ""[[parameters('allowHubToRemoteVnetTransit')]"",
                                      ""allowRemoteVnetToUseHubVnetGateways"": ""[[parameters('allowRemoteVnetToUseHubVnetGateways')]"",
                                      ""enableInternetSecurity"": ""[[parameters('enableInternetSecurity')]""
                                    }
                                  }
                                ],
                                ""outputs"": {}
                              },
                              ""parameters"": {
                                ""remoteVirtualNetwork"": {
                                  ""value"": ""[concat(subscription().id,'/resourceGroups/',variables('vNetRgName'), '/providers/','Microsoft.Network/virtualNetworks/', concat(subscription().displayName, '-vnet'))]""
                                },
                                ""vWanVhubName"": {
                                  ""value"": ""[if(and(contains(parameters('ipam')[copyIndex()],'hubVirtualNetworkConnection'),contains(parameters('ipam')[copyIndex()].hubVirtualNetworkConnection,'vWanVhubResourceId')),split(parameters('ipam')[copyIndex()].hubVirtualNetworkConnection.vWanVhubResourceId,'/')[8],json('null'))]""
                                },
                                ""allowHubToRemoteVnetTransit"": {
                                  ""value"": ""[if(and(contains(parameters('ipam')[copyIndex()],'hubVirtualNetworkConnection'),contains(parameters('ipam')[copyIndex()].hubVirtualNetworkConnection,'vWanVhubResourceId')),parameters('ipam')[copyIndex()].hubVirtualNetworkConnection.properties.allowHubToRemoteVnetTransit,json('null'))]""
                                },
                                ""allowRemoteVnetToUseHubVnetGateways"": {
                                  ""value"": ""[if(and(contains(parameters('ipam')[copyIndex()],'hubVirtualNetworkConnection'),contains(parameters('ipam')[copyIndex()].hubVirtualNetworkConnection,'vWanVhubResourceId')),parameters('ipam')[copyIndex()].hubVirtualNetworkConnection.properties.allowRemoteVnetToUseHubVnetGateways,json('null'))]""
                                },
                                ""enableInternetSecurity"": {
                                  ""value"": ""[if(and(contains(parameters('ipam')[copyIndex()],'hubVirtualNetworkConnection'),contains(parameters('ipam')[copyIndex()].hubVirtualNetworkConnection,'vWanVhubResourceId')),parameters('ipam')[copyIndex()].hubVirtualNetworkConnection.properties.enableInternetSecurity,json('null'))]""
                                }
                              }
                            }
                          },
                          {
                            ""condition"": ""[and(contains(parameters('ipam')[copyIndex()],'virtualNetworks'),contains(parameters('ipam')[copyIndex()],'virtualNetworkPeerings'),contains(parameters('ipam')[copyIndex()].virtualNetworkPeerings.properties.remoteVirtualNetwork,'id'))]"",
                            ""type"": ""Microsoft.Resources/deployments"",
                            ""apiVersion"": ""2020-06-01"",
                            ""name"": ""[concat('es-ipam-hub-',subscription().displayName,'-peering-',copyIndex())]"",
                            ""subscriptionId"": ""[if(and(contains(parameters('ipam')[copyIndex()],'virtualNetworkPeerings'),contains(parameters('ipam')[copyIndex()].virtualNetworkPeerings.properties.remoteVirtualNetwork,'id')),split(parameters('ipam')[copyIndex()].virtualNetworkPeerings.properties.remoteVirtualNetwork.id,'/')[2],json('null'))]"",
                            ""resourceGroup"": ""[if(and(contains(parameters('ipam')[copyIndex()],'virtualNetworkPeerings'),contains(parameters('ipam')[copyIndex()].virtualNetworkPeerings.properties.remoteVirtualNetwork,'id')),split(parameters('ipam')[copyIndex()].virtualNetworkPeerings.properties.remoteVirtualNetwork.id,'/')[4],json('null'))]"",
                            ""dependsOn"": [
                              ""[concat(subscription().displayName, '-vnet')]""
                            ],
                            ""properties"": {
                              ""mode"": ""Incremental"",
                              ""expressionEvaluationOptions"": {
                                ""scope"": ""inner""
                              },
                              ""template"": {
                                ""$schema"": ""https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                                ""contentVersion"": ""1.0.0.0"",
                                ""parameters"": {
                                  ""remoteVirtualNetwork"": {
                                    ""Type"": ""string"",
                                    ""defaultValue"": false
                                  },
                                  ""hubName"": {
                                    ""Type"": ""string"",
                                    ""defaultValue"": false
                                  }
                                },
                                ""variables"": {},
                                ""resources"": [
                                  {
                                    ""type"": ""Microsoft.Network/virtualNetworks/virtualNetworkPeerings"",
                                    ""name"": ""[[concat(parameters('hubName'),'/',last(split(parameters('remoteVirtualNetwork'),'/')))]"",
                                    ""apiVersion"": ""2020-05-01"",
                                    ""properties"": {
                                      ""allowVirtualNetworkAccess"": true,
                                      ""allowForwardedTraffic"": true,
                                      ""allowGatewayTransit"": true,
                                      ""useRemoteGateways"": false,
                                      ""remoteVirtualNetwork"": {
                                        ""id"": ""[[parameters('remoteVirtualNetwork')]""
                                      }
                                    }
                                  }
                                ],
                                ""outputs"": {}
                              },
                              ""parameters"": {
                                ""remoteVirtualNetwork"": {
                                  ""value"": ""[concat(subscription().id,'/resourceGroups/',variables('vNetRgName'), '/providers/','Microsoft.Network/virtualNetworks/', concat(subscription().displayName, '-vnet'))]""
                                },
                                ""hubName"": {
                                  ""value"": ""[if(and(contains(parameters('ipam')[copyIndex()],'virtualNetworkPeerings'),contains(parameters('ipam')[copyIndex()].virtualNetworkPeerings.properties.remoteVirtualNetwork,'id')),split(parameters('ipam')[copyIndex()].virtualNetworkPeerings.properties.remoteVirtualNetwork.id,'/')[8],json('null'))]""
                                }
                              }
                            }
                          }
                        ],
                        ""outputs"": {}
                      }
                    },
                    ""resourceGroup"": ""[variables('vNetRgName')]"",
                    ""copy"": {
                      ""name"": ""ipam-loop"",
                      ""count"": ""[length(parameters('ipam'))]""
                    },
                    ""condition"": ""[if(and(not(empty(parameters('ipam'))), equals(toLower(parameters('ipam')[copyIndex()].name),toLower(variables('vNetName')))),bool('true'),bool('false'))]""
                  }
                ],
                ""outputs"": {
                  ""ipam"": {
                    ""condition"": ""[bool('true')]"",
                    ""type"": ""Int"",
                    ""value"": ""[length(parameters('ipam'))]""
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-vNet"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-vNet""
}"
"Mg";"ESJH";"Deploys virtual network peering to hub";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-vnet-hubspoke";"Fixed: deployIfNotExists";"Network";"Contributor";"0";"0";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploys virtual network peering to hub"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""This policy deploys virtual network and peer to the hub"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Network"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.4791767Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""vNetName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""vNetName"",
          ""description"": ""Name of the landing zone vNet""
        }
      },
      ""vNetRgName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""vNetRgName"",
          ""description"": ""Name of the landing zone vNet RG""
        }
      },
      ""vNetLocation"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""vNetLocation"",
          ""description"": ""Location for the vNet""
        }
      },
      ""vNetCidrRange"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""vNetCidrRange"",
          ""description"": ""CIDR Range for the vNet""
        }
      },
      ""hubResourceId"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""hubResourceId"",
          ""description"": ""Resource ID for the HUB vNet""
        }
      }
    },
    ""policyRule"": {
      ""if"": {
        ""allOf"": [
          {
            ""field"": ""type"",
            ""equals"": ""Microsoft.Resources/subscriptions""
          }
        ]
      },
      ""then"": {
        ""effect"": ""deployIfNotExists"",
        ""details"": {
          ""type"": ""Microsoft.Network/virtualNetworks"",
          ""name"": ""[parameters('vNetName')]"",
          ""deploymentScope"": ""Subscription"",
          ""existenceScope"": ""ResourceGroup"",
          ""ResourceGroupName"": ""[parameters('vNetRgName')]"",
          ""roleDefinitionIds"": [
            ""/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c""
          ],
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""name"",
                ""like"": ""[parameters('vNetName')]""
              },
              {
                ""field"": ""location"",
                ""equals"": ""[parameters('vNetLocation')]""
              }
            ]
          },
          ""deployment"": {
            ""location"": ""northeurope"",
            ""properties"": {
              ""mode"": ""incremental"",
              ""parameters"": {
                ""vNetRgName"": {
                  ""value"": ""[parameters('vNetRgName')]""
                },
                ""vNetName"": {
                  ""value"": ""[parameters('vNetName')]""
                },
                ""vNetLocation"": {
                  ""value"": ""[parameters('vNetLocation')]""
                },
                ""vNetCidrRange"": {
                  ""value"": ""[parameters('vNetCidrRange')]""
                },
                ""hubResourceId"": {
                  ""value"": ""[parameters('hubResourceId')]""
                }
              },
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""vNetRgName"": {
                    ""type"": ""string""
                  },
                  ""vNetName"": {
                    ""type"": ""string""
                  },
                  ""vNetLocation"": {
                    ""type"": ""string""
                  },
                  ""vNetCidrRange"": {
                    ""type"": ""string""
                  },
                  ""vNetPeerUseRemoteGateway"": {
                    ""type"": ""bool"",
                    ""defaultValue"": false
                  },
                  ""hubResourceId"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {},
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Resources/deployments"",
                    ""apiVersion"": ""2020-06-01"",
                    ""name"": ""[concat('es-lz-vnet-',substring(uniqueString(subscription().id),0,6),'-rg')]"",
                    ""location"": ""[parameters('vNetLocation')]"",
                    ""dependsOn"": [],
                    ""properties"": {
                      ""mode"": ""Incremental"",
                      ""template"": {
                        ""$schema"": ""https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                        ""contentVersion"": ""1.0.0.0"",
                        ""parameters"": {},
                        ""variables"": {},
                        ""resources"": [
                          {
                            ""type"": ""Microsoft.Resources/resourceGroups"",
                            ""apiVersion"": ""2020-06-01"",
                            ""name"": ""[parameters('vNetRgName')]"",
                            ""location"": ""[parameters('vNetLocation')]"",
                            ""properties"": {}
                          },
                          {
                            ""type"": ""Microsoft.Resources/resourceGroups"",
                            ""apiVersion"": ""2020-06-01"",
                            ""name"": ""NetworkWatcherRG"",
                            ""location"": ""[parameters('vNetLocation')]"",
                            ""properties"": {}
                          }
                        ],
                        ""outputs"": {}
                      }
                    }
                  },
                  {
                    ""type"": ""Microsoft.Resources/deployments"",
                    ""apiVersion"": ""2020-06-01"",
                    ""name"": ""[concat('es-lz-vnet-',substring(uniqueString(subscription().id),0,6))]"",
                    ""dependsOn"": [
                      ""[concat('es-lz-vnet-',substring(uniqueString(subscription().id),0,6),'-rg')]""
                    ],
                    ""properties"": {
                      ""mode"": ""Incremental"",
                      ""template"": {
                        ""$schema"": ""https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                        ""contentVersion"": ""1.0.0.0"",
                        ""parameters"": {},
                        ""variables"": {},
                        ""resources"": [
                          {
                            ""type"": ""Microsoft.Network/virtualNetworks"",
                            ""apiVersion"": ""2020-06-01"",
                            ""name"": ""[parameters('vNetName')]"",
                            ""location"": ""[parameters('vNetLocation')]"",
                            ""dependsOn"": [],
                            ""properties"": {
                              ""addressSpace"": {
                                ""addressPrefixes"": [
                                  ""[parameters('vNetCidrRange')]""
                                ]
                              }
                            }
                          },
                          {
                            ""type"": ""Microsoft.Network/virtualNetworks/virtualNetworkPeerings"",
                            ""apiVersion"": ""2020-05-01"",
                            ""name"": ""[concat(parameters('vNetName'), '/peerToHub')]"",
                            ""dependsOn"": [
                              ""[parameters('vNetName')]""
                            ],
                            ""properties"": {
                              ""remoteVirtualNetwork"": {
                                ""id"": ""[parameters('hubResourceId')]""
                              },
                              ""allowVirtualNetworkAccess"": true,
                              ""allowForwardedTraffic"": true,
                              ""allowGatewayTransit"": false,
                              ""useRemoteGateways"": ""[parameters('vNetPeerUseRemoteGateway')]""
                            }
                          },
                          {
                            ""type"": ""Microsoft.Resources/deployments"",
                            ""apiVersion"": ""2020-06-01"",
                            ""name"": ""[concat('es-lz-hub-',substring(uniqueString(subscription().id),0,6),'-peering')]"",
                            ""subscriptionId"": ""[split(parameters('hubResourceId'),'/')[2]]"",
                            ""resourceGroup"": ""[split(parameters('hubResourceId'),'/')[4]]"",
                            ""dependsOn"": [
                              ""[parameters('vNetName')]""
                            ],
                            ""properties"": {
                              ""mode"": ""Incremental"",
                              ""expressionEvaluationOptions"": {
                                ""scope"": ""inner""
                              },
                              ""template"": {
                                ""$schema"": ""https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                                ""contentVersion"": ""1.0.0.0"",
                                ""parameters"": {
                                  ""remoteVirtualNetwork"": {
                                    ""Type"": ""string"",
                                    ""defaultValue"": false
                                  },
                                  ""hubName"": {
                                    ""Type"": ""string"",
                                    ""defaultValue"": false
                                  }
                                },
                                ""variables"": {},
                                ""resources"": [
                                  {
                                    ""type"": ""Microsoft.Network/virtualNetworks/virtualNetworkPeerings"",
                                    ""name"": ""[[concat(parameters('hubName'),'/',last(split(parameters('remoteVirtualNetwork'),'/')))]"",
                                    ""apiVersion"": ""2020-05-01"",
                                    ""properties"": {
                                      ""allowVirtualNetworkAccess"": true,
                                      ""allowForwardedTraffic"": true,
                                      ""allowGatewayTransit"": true,
                                      ""useRemoteGateways"": false,
                                      ""remoteVirtualNetwork"": {
                                        ""id"": ""[[parameters('remoteVirtualNetwork')]""
                                      }
                                    }
                                  }
                                ],
                                ""outputs"": {}
                              },
                              ""parameters"": {
                                ""remoteVirtualNetwork"": {
                                  ""value"": ""[concat(subscription().id,'/resourceGroups/',parameters('vNetRgName'), '/providers/','Microsoft.Network/virtualNetworks/', parameters('vNetName'))]""
                                },
                                ""hubName"": {
                                  ""value"": ""[split(parameters('hubResourceId'),'/')[8]]""
                                }
                              }
                            }
                          }
                        ],
                        ""outputs"": {}
                      }
                    },
                    ""resourceGroup"": ""[parameters('vNetRgName')]""
                  }
                ],
                ""outputs"": {}
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-VNET-HubSpoke"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-VNET-HubSpoke""
}"
"Mg";"ESJH";"Deploy the Virtual WAN in the specific region";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-vwan";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Network";"Network Contributor";"0";"0";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy the Virtual WAN in the specific region"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploy the Virtual WAN in the specific region."",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Network"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.4945187Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""vwanname"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""vwanname"",
          ""description"": ""Name of the Virtual WAN""
        }
      },
      ""vwanRegion"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""vwanRegion"",
          ""description"": ""Select Azure region for Virtual WAN"",
          ""strongType"": ""location""
        }
      },
      ""rgName"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""rgName"",
          ""description"": ""Provide name for resource group.""
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""allOf"": [
          {
            ""field"": ""type"",
            ""equals"": ""Microsoft.Resources/subscriptions""
          }
        ]
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Network/virtualWans"",
          ""deploymentScope"": ""Subscription"",
          ""existenceScope"": ""ResourceGroup"",
          ""name"": ""[parameters('vwanname')]"",
          ""resourceGroupName"": ""[parameters('rgName')]"",
          ""roleDefinitionIds"": [
            ""/providers/Microsoft.Authorization/roleDefinitions/4d97b98b-1d4f-4787-a291-c67834d212e7""
          ],
          ""deployment"": {
            ""location"": ""northeurope"",
            ""properties"": {
              ""mode"": ""incremental"",
              ""parameters"": {
                ""rgName"": {
                  ""value"": ""[parameters('rgName')]""
                },
                ""vwanname"": {
                  ""value"": ""[parameters('vwanname')]""
                },
                ""vwanRegion"": {
                  ""value"": ""[parameters('vwanRegion')]""
                }
              },
              ""template"": {
                ""$schema"": ""http://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""rgName"": {
                    ""type"": ""string""
                  },
                  ""vwanname"": {
                    ""type"": ""string""
                  },
                  ""vwanRegion"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {
                  ""vwansku"": ""Standard""
                },
                ""resources"": [
                  {
                    ""type"": ""Microsoft.Resources/resourceGroups"",
                    ""apiVersion"": ""2018-05-01"",
                    ""name"": ""[parameters('rgName')]"",
                    ""location"": ""[deployment().location]"",
                    ""properties"": {}
                  },
                  {
                    ""type"": ""Microsoft.Resources/deployments"",
                    ""apiVersion"": ""2018-05-01"",
                    ""name"": ""vwan"",
                    ""resourceGroup"": ""[parameters('rgName')]"",
                    ""dependsOn"": [
                      ""[resourceId('Microsoft.Resources/resourceGroups/', parameters('rgName'))]""
                    ],
                    ""properties"": {
                      ""mode"": ""Incremental"",
                      ""template"": {
                        ""$schema"": ""http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json"",
                        ""contentVersion"": ""1.0.0.0"",
                        ""parameters"": {},
                        ""resources"": [
                          {
                            ""type"": ""Microsoft.Network/virtualWans"",
                            ""apiVersion"": ""2020-05-01"",
                            ""location"": ""[parameters('vwanRegion')]"",
                            ""name"": ""[parameters('vwanname')]"",
                            ""properties"": {
                              ""virtualHubs"": [],
                              ""vpnSites"": [],
                              ""type"": ""[variables('vwansku')]""
                            }
                          }
                        ],
                        ""outputs"": {}
                      }
                    }
                  }
                ],
                ""outputs"": {}
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-vWAN"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-vWAN""
}"
"Mg";"ESJH";"Deploy Windows Domain Join Extension with keyvault configuration";"/providers/microsoft.management/managementgroups/esjh/providers/microsoft.authorization/policydefinitions/deploy-windows-domainjoin";"Default: DeployIfNotExists; Allowed: DeployIfNotExists,Disabled";"Guest Configuration";"Virtual Machine Contributor";"0";"0";"2021-01-10 20:57:38";"ObjectType: User Member, ObjectDisplayName: ESDeploymentAccount, ObjectSignInName: ESDeploymentAccount@AzGovViz.onmicrosoft.com, ObjectId: b790b1e1-6f46-488b-8c5a-708b0db9a149";"";"";"{
  ""properties"": {
    ""displayName"": ""Deploy Windows Domain Join Extension with keyvault configuration"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""description"": ""Deploy Windows Domain Join Extension with keyvault configuration when the extension does not exist on a given windows Virtual Machine"",
    ""metadata"": {
      ""version"": ""1.0.0"",
      ""category"": ""Guest Configuration"",
      ""createdBy"": ""b790b1e1-6f46-488b-8c5a-708b0db9a149"",
      ""createdOn"": ""2021-01-10T20:57:38.5257789Z"",
      ""updatedBy"": null,
      ""updatedOn"": null
    },
    ""parameters"": {
      ""domainUsername"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""domainUsername"",
          ""description"": null
        }
      },
      ""domainPassword"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""domainPassword"",
          ""description"": null
        }
      },
      ""domainFQDN"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""domainFQDN"",
          ""description"": null
        }
      },
      ""domainOUPath"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""domainOUPath"",
          ""description"": null
        }
      },
      ""keyVaultResourceId"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""keyVaultResourceId"",
          ""description"": null
        }
      },
      ""effect"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""Effect"",
          ""description"": ""Enable or disable the execution of the policy""
        },
        ""allowedValues"": [
          ""DeployIfNotExists"",
          ""Disabled""
        ],
        ""defaultValue"": ""DeployIfNotExists""
      }
    },
    ""policyRule"": {
      ""if"": {
        ""allOf"": [
          {
            ""field"": ""type"",
            ""equals"": ""Microsoft.Compute/virtualMachines""
          },
          {
            ""field"": ""Microsoft.Compute/imagePublisher"",
            ""equals"": ""MicrosoftWindowsServer""
          },
          {
            ""field"": ""Microsoft.Compute/imageOffer"",
            ""equals"": ""WindowsServer""
          },
          {
            ""field"": ""Microsoft.Compute/imageSKU"",
            ""in"": [
              ""2008-R2-SP1"",
              ""2008-R2-SP1-smalldisk"",
              ""2008-R2-SP1-zhcn"",
              ""2012-Datacenter"",
              ""2012-datacenter-gensecond"",
              ""2012-Datacenter-smalldisk"",
              ""2012-datacenter-smalldisk-g2"",
              ""2012-Datacenter-zhcn"",
              ""2012-datacenter-zhcn-g2"",
              ""2012-R2-Datacenter"",
              ""2012-r2-datacenter-gensecond"",
              ""2012-R2-Datacenter-smalldisk"",
              ""2012-r2-datacenter-smalldisk-g2"",
              ""2012-R2-Datacenter-zhcn"",
              ""2012-r2-datacenter-zhcn-g2"",
              ""2016-Datacenter"",
              ""2016-datacenter-gensecond"",
              ""2016-datacenter-gs"",
              ""2016-Datacenter-Server-Core"",
              ""2016-datacenter-server-core-g2"",
              ""2016-Datacenter-Server-Core-smalldisk"",
              ""2016-datacenter-server-core-smalldisk-g2"",
              ""2016-Datacenter-smalldisk"",
              ""2016-datacenter-smalldisk-g2"",
              ""2016-Datacenter-with-Containers"",
              ""2016-datacenter-with-containers-g2"",
              ""2016-Datacenter-with-RDSH"",
              ""2016-Datacenter-zhcn"",
              ""2016-datacenter-zhcn-g2"",
              ""2019-Datacenter"",
              ""2019-Datacenter-Core"",
              ""2019-datacenter-core-g2"",
              ""2019-Datacenter-Core-smalldisk"",
              ""2019-datacenter-core-smalldisk-g2"",
              ""2019-Datacenter-Core-with-Containers"",
              ""2019-datacenter-core-with-containers-g2"",
              ""2019-Datacenter-Core-with-Containers-smalldisk"",
              ""2019-datacenter-core-with-containers-smalldisk-g2"",
              ""2019-datacenter-gensecond"",
              ""2019-datacenter-gs"",
              ""2019-Datacenter-smalldisk"",
              ""2019-datacenter-smalldisk-g2"",
              ""2019-Datacenter-with-Containers"",
              ""2019-datacenter-with-containers-g2"",
              ""2019-Datacenter-with-Containers-smalldisk"",
              ""2019-datacenter-with-containers-smalldisk-g2"",
              ""2019-Datacenter-zhcn"",
              ""2019-datacenter-zhcn-g2"",
              ""Datacenter-Core-1803-with-Containers-smalldisk"",
              ""datacenter-core-1803-with-containers-smalldisk-g2"",
              ""Datacenter-Core-1809-with-Containers-smalldisk"",
              ""datacenter-core-1809-with-containers-smalldisk-g2"",
              ""Datacenter-Core-1903-with-Containers-smalldisk"",
              ""datacenter-core-1903-with-containers-smalldisk-g2"",
              ""datacenter-core-1909-with-containers-smalldisk"",
              ""datacenter-core-1909-with-containers-smalldisk-g1"",
              ""datacenter-core-1909-with-containers-smalldisk-g2""
            ]
          }
        ]
      },
      ""then"": {
        ""effect"": ""[parameters('effect')]"",
        ""details"": {
          ""type"": ""Microsoft.Compute/virtualMachines/extensions"",
          ""roleDefinitionIds"": [
            ""/providers/Microsoft.Authorization/roleDefinitions/9980e02c-c2be-4d73-94e8-173b1dc7cf3c""
          ],
          ""existenceCondition"": {
            ""allOf"": [
              {
                ""field"": ""Microsoft.Compute/virtualMachines/extensions/type"",
                ""equals"": ""JsonADDomainExtension""
              },
              {
                ""field"": ""Microsoft.Compute/virtualMachines/extensions/publisher"",
                ""equals"": ""Microsoft.Compute""
              }
            ]
          },
          ""deployment"": {
            ""properties"": {
              ""mode"": ""incremental"",
              ""parameters"": {
                ""vmName"": {
                  ""value"": ""[field('name')]""
                },
                ""location"": {
                  ""value"": ""[field('location')]""
                },
                ""domainUsername"": {
                  ""reference"": {
                    ""keyVault"": {
                      ""id"": ""[parameters('keyVaultResourceId')]""
                    },
                    ""secretName"": ""[parameters('domainUsername')]""
                  }
                },
                ""domainPassword"": {
                  ""reference"": {
                    ""keyVault"": {
                      ""id"": ""[parameters('keyVaultResourceId')]""
                    },
                    ""secretName"": ""[parameters('domainPassword')]""
                  }
                },
                ""domainOUPath"": {
                  ""value"": ""[parameters('domainOUPath')]""
                },
                ""domainFQDN"": {
                  ""value"": ""[parameters('domainFQDN')]""
                },
                ""keyVaultResourceId"": {
                  ""value"": ""[parameters('keyVaultResourceId')]""
                }
              },
              ""template"": {
                ""$schema"": ""https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#"",
                ""contentVersion"": ""1.0.0.0"",
                ""parameters"": {
                  ""vmName"": {
                    ""type"": ""string""
                  },
                  ""location"": {
                    ""type"": ""string""
                  },
                  ""domainUsername"": {
                    ""type"": ""string""
                  },
                  ""domainPassword"": {
                    ""type"": ""securestring""
                  },
                  ""domainFQDN"": {
                    ""type"": ""string""
                  },
                  ""domainOUPath"": {
                    ""type"": ""string""
                  },
                  ""keyVaultResourceId"": {
                    ""type"": ""string""
                  }
                },
                ""variables"": {
                  ""domainJoinOptions"": 3,
                  ""vmName"": ""[parameters('vmName')]""
                },
                ""resources"": [
                  {
                    ""apiVersion"": ""2015-06-15"",
                    ""type"": ""Microsoft.Compute/virtualMachines/extensions"",
                    ""name"": ""[concat(variables('vmName'),'/joindomain')]"",
                    ""location"": ""[resourceGroup().location]"",
                    ""properties"": {
                      ""publisher"": ""Microsoft.Compute"",
                      ""type"": ""JsonADDomainExtension"",
                      ""typeHandlerVersion"": ""1.3"",
                      ""autoUpgradeMinorVersion"": true,
                      ""settings"": {
                        ""Name"": ""[parameters('domainFQDN')]"",
                        ""User"": ""[parameters('domainUserName')]"",
                        ""Restart"": ""true"",
                        ""Options"": ""[variables('domainJoinOptions')]"",
                        ""OUPath"": ""[parameters('domainOUPath')]""
                      },
                      ""protectedSettings"": {
                        ""Password"": ""[parameters('domainPassword')]""
                      }
                    }
                  }
                ],
                ""outputs"": {}
              }
            }
          }
        }
      }
    }
  },
  ""id"": ""/providers/Microsoft.Management/managementGroups/ESJH/providers/Microsoft.Authorization/policyDefinitions/Deploy-Windows-DomainJoin"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""Deploy-Windows-DomainJoin""
}"
"Sub";"f28ba982-5ed0-4033-9bdf-e45e4b5df466";"Create NSG Rule";"/subscriptions/f28ba982-5ed0-4033-9bdf-e45e4b5df466/providers/microsoft.authorization/policydefinitions/4e7e976d-d94c-47a3-a534-392c641cecd8";"Fixed: append";"CUST_NSG";"n/a";"0";"0";"2021-05-18 18:01:38";"ObjectType: User Member, ObjectDisplayName: Joe Dalton, ObjectSignInName: joe.dalton@AzGovViz.onmicrosoft.com, ObjectId: acf4c68f-7b15-4d70-935b-26116fc2426a";"2021-05-18 18:22:00";"ObjectType: User Member, ObjectDisplayName: Joe Dalton, ObjectSignInName: joe.dalton@AzGovViz.onmicrosoft.com, ObjectId: acf4c68f-7b15-4d70-935b-26116fc2426a";"{
  ""properties"": {
    ""displayName"": ""Create NSG Rule"",
    ""policyType"": ""Custom"",
    ""mode"": ""All"",
    ""metadata"": {
      ""createdBy"": ""acf4c68f-7b15-4d70-935b-26116fc2426a"",
      ""createdOn"": ""2021-05-18T18:01:38.7866652Z"",
      ""updatedBy"": ""acf4c68f-7b15-4d70-935b-26116fc2426a"",
      ""updatedOn"": ""2021-05-18T18:22:00.499589Z"",
      ""category"": ""CUST_NSG""
    },
    ""parameters"": {
      ""name"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""name"",
          ""description"": null
        }
      },
      ""protocol"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""protocol"",
          ""description"": null
        }
      },
      ""access"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""access"",
          ""description"": null
        }
      },
      ""priority"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""priority"",
          ""description"": null
        }
      },
      ""direction"": {
        ""type"": ""String"",
        ""metadata"": {
          ""displayName"": ""direction"",
          ""description"": null
        }
      },
      ""sourcePortRanges"": {
        ""type"": ""Array"",
        ""metadata"": {
          ""displayName"": ""sourcePortRanges"",
          ""description"": null
        }
      },
      ""destinationPortRanges"": {
        ""type"": ""Array"",
        ""metadata"": {
          ""displayName"": ""destinationPortRanges"",
          ""description"": null
        }
      },
      ""sourceAddressPrefixes"": {
        ""type"": ""Array"",
        ""metadata"": {
          ""displayName"": ""sourceAddressPrefixes"",
          ""description"": null
        }
      },
      ""destinationAddressPrefixes"": {
        ""type"": ""Array"",
        ""metadata"": {
          ""displayName"": ""destinationAddressPrefixes"",
          ""description"": null
        }
      }
    },
    ""policyRule"": {
      ""if"": {
        ""allOf"": [
          {
            ""field"": ""type"",
            ""equals"": ""Microsoft.Network/networkSecurityGroups""
          }
        ]
      },
      ""then"": {
        ""effect"": ""append"",
        ""details"": [
          {
            ""field"": ""Microsoft.Network/networkSecurityGroups/securityRules[*]"",
            ""value"": {
              ""name"": ""[parameters('name')]"",
              ""properties"": {
                ""protocol"": ""[parameters('protocol')]"",
                ""sourcePortRange"": ""[if(equals(length(parameters('sourcePortRanges')), 1), first(parameters('sourcePortRanges')), '')]"",
                ""destinationPortRange"": ""[if(equals(length(parameters('destinationPortRanges')), 1), first(parameters('destinationPortRanges')), '')]"",
                ""sourceAddressPrefix"": ""[if(equals(length(parameters('sourceAddressPrefixes')), 1), first(parameters('sourceAddressPrefixes')), '')]"",
                ""destinationAddressPrefix"": ""[if(equals(length(parameters('destinationAddressPrefixes')), 1), first(parameters('destinationAddressPrefixes')), '')]"",
                ""access"": ""[parameters('access')]"",
                ""priority"": ""[parameters('priority')]"",
                ""direction"": ""[parameters('direction')]"",
                ""sourcePortRanges"": ""[if(greater(length(parameters('sourcePortRanges')), 1), parameters('sourcePortRanges'), take(parameters('sourcePortRanges'),0))]"",
                ""destinationPortRanges"": ""[if(greater(length(parameters('destinationPortRanges')), 1), parameters('destinationPortRanges'), take(parameters('destinationPortRanges'),0))]"",
                ""sourceAddressPrefixes"": ""[if(greater(length(parameters('sourceAddressPrefixes')), 1), parameters('sourceAddressPrefixes'), take(parameters('sourceAddressPrefixes'),0))]"",
                ""destinationAddressPrefixes"": ""[if(greater(length(parameters('destinationAddressPrefixes')), 1), parameters('destinationAddressPrefixes'), take(parameters('destinationAddressPrefixes'),0))]""
              }
            }
          }
        ]
      }
    }
  },
  ""id"": ""/subscriptions/f28ba982-5ed0-4033-9bdf-e45e4b5df466/providers/Microsoft.Authorization/policyDefinitions/4e7e976d-d94c-47a3-a534-392c641cecd8"",
  ""type"": ""Microsoft.Authorization/policyDefinitions"",
  ""name"": ""4e7e976d-d94c-47a3-a534-392c641cecd8""
}"

